const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/CreateEditForm.js","js/vendor.js","css/vendor.css","js/index.js","css/index.css"])))=>i.map(i=>d[i]);
import{e as n,E as o,z as m,x as c,L as O,O as w,c as h,at as ee,a7 as I,K as g,aE as F,_ as N,A as we,r as k,aG as B,aB as R,aC as P,aA as L,aH as Fe,aD as ae,aq as Z,ar as te,a6 as Y,aI as ce,ad as fe,aJ as U,aK as _,X as b,ag as q,aL as Te,I as x,aM as ne,T as E,aa as D,aF as A,aN as K,am as re,an as xe,ao as De,aO as Se,aP as pe,aQ as Me,aR as Oe,aS as Re,aT as Ee,aU as le,aV as he,aW as ye,aX as Ve,aY as se,ap as Pe,D as X,Y as de,aZ as Ae,a_ as Le,a$ as oe,b0 as Be,b1 as Ne}from"./vendor.js";import{_ as v,D as $,H as ue}from"./index.js";const qe={name:"CreateButton",props:{createButtonText:{type:String,default:""},model:{type:[Object,Function],required:!0},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},computed:{canCreate(){return!1},canCreateMsgType(){return""},canCreatePart2(){return this.canCreate},canEdit(){return this.model.rules.creatable()},canCreateMsg(){return this.getMsg(this.canCreateMsgType)}},methods:{emitCreateItem(e){this.$emit("createItem",e)},getMsg(e){return""}},mounted(){}};function Ke(e,l,t,s,i,a){return n(),o("div",null,[m(F,{onClick:a.emitCreateItem,disable:!a.canEdit,outline:""},{default:c(()=>[O(w(t.createButtonText?t.createButtonText:"New")+" ",1),a.canCreateMsg.length?(n(),h(ee,{key:0,bottom:"",disable:a.canCreatePart2},{default:c(()=>[I("span",null,w(a.canCreateMsg),1)]),_:1},8,["disable"])):g("",!0)]),_:1},8,["onClick","disable"])])}const ge=v(qe,[["render",Ke],["__file","CreateButton.vue"]]),Ye={name:"RelationComponent",components:{SuperTable:()=>N(()=>Promise.resolve().then(()=>z),void 0)},props:{hideLabel:{type:Boolean,default(){return!1}},configs:{type:Object,default:()=>({})},lookup:{type:Number,default:null},modelValue:{type:Number,default:null},readonly:{type:Boolean,default:!1},rules:{type:Array,default(){return[()=>!0]}}},data(){return{showRelationDialog:!1,newlookup:{}}},computed:{isNullable(){return this.configs.meta.field.parent.fields()[this.foreignKey].isNullable},displayNameField(){const e=this.configs.meta.field.parent.fields();return Object.keys(e).find(l=>l!=="id"&&e[l]instanceof we)},computedValue:{get(){let e="";const l=this.configs.meta.field.parent.query().whereId(+this.modelValue).get();return l.length&&(e=l[0][this.configs.meta.lookupDisplayField]),e},set(e){this.$emit("update:modelValue",e)}}},methods:{input(e){this.newlookup=e,this.showRelationDialog=!1,this.$emit("update:modelValue",e.id)},click(){this.readonly||(this.showRelationDialog=!0)}}},je=I("div",{class:"text-h6"},"Select Item",-1);function Ge(e,l,t,s,i,a){const d=k("SuperTable");return n(),o("div",null,[m(B,{onClick:a.click,label:t.configs.label,modelValue:a.computedValue,rules:t.configs.meta.rules,error:!1,"error-message":"",readonly:"",disable:t.readonly,outlined:"",dense:""},null,8,["onClick","label","modelValue","rules","disable"]),m(L,{modelValue:i.showRelationDialog,"onUpdate:modelValue":l[0]||(l[0]=r=>i.showRelationDialog=r),"max-width":"800px"},{default:c(()=>[m(R,null,{default:c(()=>[m(P,null,{default:c(()=>[je]),_:1}),m(P,null,{default:c(()=>[m(d,{isForSelectingRelation:!0,canEdit:!1,modelValue:t.modelValue,"onUpdate:modelValue":a.input,model:t.configs.meta.field.parent,rules:t.rules},null,8,["modelValue","onUpdate:modelValue","model","rules"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const Ue=v(Ye,[["render",Ge],["__file","RelationComponent.vue"]]),He={name:"SearchGooglePlace",props:{hideLabel:{type:Boolean,default:!1},modelValue:{type:String,default:null},configs:{type:Object,default:()=>({})}},data(){return{showDialog:!1,retries:0,place:null,internalModelValue:this.modelValue}},watch:{modelValue(e){this.internalModelValue=e},showDialog(e){e&&this.initGoogleMaps()}},methods:{emitPlaceChanged(e){this.$emit("placeSelected",e),this.place=e,e.geometry&&(this.internalModelValue=e.name,this.$emit("update:modelValue",e.name))},initGoogleMaps(){new Fe({apiKey:"AIzaSyAENUjZ_P7ulkAcDb-U8Htn6VSv_ioEKWE",libraries:["places"]}).load().then(()=>{const l=this.$refs.autocompleteInput.$el.querySelector("input"),t=new google.maps.places.Autocomplete(l);t.addListener("place_changed",()=>{const s=t.getPlace();this.emitPlaceChanged(s)})}).catch(l=>{console.error("Failed to load Google Maps API:",l)})}}},We=I("div",{class:"text-subtitle1"},"Search Place",-1);function ze(e,l,t,s,i,a){return n(),o("div",null,[m(B,{label:t.configs.label,modelValue:i.internalModelValue,"onUpdate:modelValue":l[0]||(l[0]=d=>i.internalModelValue=d),error:!1,"error-message":"",onClick:l[1]||(l[1]=d=>i.showDialog=!0),readonly:"",filled:"",dense:""},null,8,["label","modelValue"]),m(L,{modelValue:i.showDialog,"onUpdate:modelValue":l[4]||(l[4]=d=>i.showDialog=d)},{default:c(()=>[m(R,{style:{width:"700px","max-width":"calc(-32px + 100vw)"}},{default:c(()=>[m(P,null,{default:c(()=>[We,m(B,{class:"CustomPlaceSearch",label:"Place",modelValue:i.internalModelValue,"onUpdate:modelValue":l[2]||(l[2]=d=>i.internalModelValue=d),error:!1,"error-message":"",ref:"autocompleteInput",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),m(ae,{align:"right"},{default:c(()=>[m(F,{color:"primary",onClick:l[3]||(l[3]=d=>i.showDialog=!1)},{default:c(()=>[O("OK")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const Qe=v(He,[["render",ze],["__file","SearchGooglePlace.vue"]]);class S{static quickListsIsMobile(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}static mapPlaceFields(){return[{flag:"mapExtraFormattedAddress",googleType:"simple",googleName:"formatted_address"},{flag:"mapExtraPlaceID",googleType:"simple",googleName:"place_id"},{flag:"mapExtraGeoLocLong",googleType:"mapGeoLoc",googleName:"lng"},{flag:"mapExtraGeoLocLat",googleType:"mapGeoLoc",googleName:"lat"},{flag:"relForeignKeyMapExtraRelCountry",googleType:"components",googleName:"country"},{flag:"relForeignKeyMapExtraRelAdminArea1",googleType:"components",googleName:"administrative_area_level_1"},{flag:"relForeignKeyMapExtraRelAdminArea2",googleType:"components",googleName:"administrative_area_level_2"},{flag:"relForeignKeyMapExtraRelLocality",googleType:"components",googleName:"locality"},{flag:"relForeignKeyMapExtraRelSublocality",googleType:"components",googleName:["sublocality_level_1","sublocality_level_2"]}]}static quickListsGetIfMatchesAllChecks(l,t){for(const[s,i]of Object.entries(t))if(typeof i=="object"&&!Array.isArray(i)&&i!==null){if(i!=null&&i.value&&i.usageType==="timeRangeStart"&&i.value.range.start){const a=new Date(i.value.range.start),d=new Date(i.value.range.end),r=new Date(l[s]);return a<r&&r<d}}else if(i!==null)return l[s]==i;return!0}static computedAttrs(l,t=[]){let s=$.find(l.entity);return s||($.Generate(l),s=$.find(l.entity)),this.computedAttrs2(s.fields,t)}static async downloadPdf(l,t,s=0,i=null,a=null){}static computedAttrs2(l,t=[]){let s=[];for(const i of l)i.usageType.startsWith("relLookupNormal")?t.includes(i.meta.foreignKey)?s.push({...i,meta:{important:i.important,...i.meta,hideField:!0}}):s.push({...i,meta:{important:i.important,...i.meta,hideField:!1}}):t.includes(i.name)?s.push({...i,meta:{important:i.important,...i.meta,hideField:!0}}):s.push({...i,meta:{important:i.important,...i.meta,hideField:!1}});return s}static SupaerTableHeaders(l,t=[],s=!0,i=!1){let a=[];const d=this.computedAttrs(l,t);for(const r of d)if(!r.usageType.startsWith("relForeignKey"))if(r.usageType.startsWith("relLookup")){const u=this.computedAttrs(r.meta.field.parent,t);let f=[];for(const p of u)p.usageType.startsWith("relForeignKey")||f.push({usageType:p.usageType,dataType:p.dataType,meta:p.meta,name:`${r.name}.${p.name}`,align:"left",label:p.label,field:y=>y[r.name]&&y[r.name][p.name],format:y=>`${y}`,sortable:!0});a.push({usageType:r.usageType,dataType:r.dataType,meta:r.meta,headerParentFields:f,name:r.name,align:"left",label:r.label,field:r.name,sortable:!0,children:f})}else a.push({usageType:r.usageType,dataType:r.dataType,meta:r.meta,name:r.name,align:"left",label:r.label,field:r.name,sortable:!0});return s&&a.push({usageType:"actions",dataType:"actions",name:"actions",align:"right",label:"Actions",field:"actions",sortable:!1}),a=a.filter(r=>{if(i){if(!r.usageType.startsWith("relForeignKey"))return!0}else return!r.usageType.startsWith("relForeignKey")&&!r.usageType.startsWith("relLookupMapExtra")&&!r.usageType.startsWith("mapExtra")}),a}static preparePayload(l,t){let s=[];for(const i of t)typeof(l==null?void 0:l[i.name])!="undefined"&&(i.usageType.startsWith("relForeignKey")?s[i.meta.foreignKey]=l[i.meta.foreignKey]:i.usageType.startsWith("relLookup")||i.usageType.startsWith("relChildren")||(["timestampType","readOnlyTimestampType","timeRangeStart","timeRangeEnd"].includes(i.usageType)?l[i.name]&&(s[i.name]=l[i.name]):s[i.name]=l[i.name]));return delete s.$id,s}}const Je={name:"SuperSelect",props:{hideBottomSpace:{type:Boolean,default(){return!1}},errorMessage:{type:String,default(){return null}},hideLabel:{type:Boolean,default(){return!1}},maxPages:{type:[Number,Object],default:1},page:{type:[Number,Object],default:1},modelValue:{type:[Number,Object,String],default:null},model:{type:[Object,Function],required:!0},disabled:{type:Boolean,default:!1},modelField:{type:Object,default:()=>({})},displayMapField:{type:Boolean,default:!1},excludedCols:{type:Array,default:()=>[]},readonly:{type:Boolean,default:!1},variant:{type:String,default:"outlined"},density:{type:String,default:"compact"},allowAll:{type:Boolean,default:!1},rules:{type:Array,default:()=>[()=>!0]},items:{type:Array,default(){return[]}},activated:{type:Boolean,default(){return!1}},loading:{type:Boolean,default(){return!1}}},data(){return{timeout:null,search:"",totalPages:1,preSelectedItem:null,loadingInner:!1}},computed:{compLabel(){if(!this.hideLabel)return this.modelField.label},compLoading(){return this.loadingInner||this.loading},disabledComp(){return this.disabled||this.readonly},quickListsIsMobile(){return S.quickListsIsMobile()},headers(){return S.SupaerTableHeaders(this.model,this.excludedCols,!1,this.displayMapField)},modelValueComp(){return this.itemsComp.find(l=>l.id===this.modelValue)?this.modelValue:null},itemsComp(){let e=[];if(!this.disabled){if(e.push({label:"",id:null}),this.allowAll&&e.push({label:"All",id:null}),!this.activated){e=e.filter(t=>t.id!==this.modelValue);let l="";this.preSelectedItem&&(l=this.preSelectedItem[this.model.titleKey]),this.modelValue&&e.push({label:l,id:this.modelValue})}for(const l of this.items)e.push({label:l[this.model.titleKey],id:l[this.model.primaryKey]});e.push({label:"",id:null})}return e}},methods:{hidePopup(){this.$refs.selectRef.hidePopup()},pageUpdate(e){this.$emit("update:page",e)},updateValue(e){const l={};l[this.model.primaryKey]=e,this.$emit("update:modelValue",e,l)},fetchDefaultItem(){this.modelValue&&!this.items.length&&(this.loadingInner=!0,this.model.FetchById(this.modelValue,[],{},{}).then(e=>{this.preSelectedItem=e.response.data.data,this.loadingInner=!1}).catch(()=>{this.loadingInner=!1}))}},watch:{search(e){this.disabled||(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.$emit("search",e)},300))},modelValue(e){this.fetchDefaultItem()}},mounted(){this.fetchDefaultItem()}},Ze={class:"q-mb-md"};function Xe(e,l,t,s,i,a){return n(),o("div",null,[m(U,{ref:"selectRef",modelValue:a.modelValueComp,"onUpdate:modelValue":a.updateValue,options:a.itemsComp,"option-label":"label","option-value":t.model.primaryKey,"emit-value":!0,"map-options":!0,label:a.compLabel,disable:a.disabledComp,loading:a.compLoading,readonly:t.readonly,dense:t.density==="compact",filled:"","menu-props":{offsetY:!0},rules:t.rules,error:!!t.errorMessage,errorMessage:t.errorMessage,hideBottomSpace:t.hideBottomSpace},{option:c(d=>[d.index===0?(n(),h(Z,{key:0,class:"q-mt-none q-px-md"},{default:c(()=>[m(te,null,{default:c(()=>[I("div",Ze,[Y(e.$slots,"default")]),m(B,{modelValue:i.search,"onUpdate:modelValue":l[0]||(l[0]=r=>i.search=r),error:!1,"error-message":"",label:"Search",dense:"",outlined:"","single-line":"","hide-bottom-space":"",class:"q-mt-none q-pa-none"},null,8,["modelValue"])]),_:3})]),_:3})):d.index===a.itemsComp.length-1?(n(),h(Z,{key:1,class:"text-center q-pa-md"},{default:c(()=>[m(ce,{modelValue:t.page,max:t.maxPages,"onUpdate:modelValue":a.pageUpdate,input:""},null,8,["modelValue","max","onUpdate:modelValue"])]),_:1})):(n(),h(Z,fe({key:2},d.itemProps,{key:d.index,label:d.opt.label,value:d.opt.id}),{default:c(()=>[m(te,null,{default:c(()=>[I("div",null,w(d.opt.label),1)]),_:2},1024)]),_:2},1040,["label","value"]))]),_:3},8,["modelValue","onUpdate:modelValue","options","option-value","label","disable","loading","readonly","dense","rules","error","errorMessage","hideBottomSpace"])])}const be=v(Je,[["render",Xe],["__file","SuperSelect.vue"]]),$e={name:"DatapointForDisplayInner",components:{},data(){return{showImageModel:!1}},props:{protectImage:{type:Boolean,default(){return!1}},isTag:{type:Boolean,default(){return!1}},isHeading:{type:Boolean,default(){return!1}},hideLabel:{type:Boolean,default(){return!1}},header:{type:Object,default(){return{}}},item:{type:Object,default(){return{}}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},methods:{clickParent(e,l){const t=l.meta.field.parent;t.openRecord(e[t.primaryKey],e,this.$router)},truncateStr(e){let l="";return e&&(l=e.length>40?e.substring(0,40)+"...":e),l},disabled(){var l;let e=!1;return(l=this.superOptions.model.rules)!=null&&l.editable&&(e=this.superOptions.model.rules.editable(this.item)),!e},deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)},formatTimestamp(e){return e?_.tz(e,"YYYY-MM-DDTHH:mm:ss.SSSSSSZ","UTC").tz("Africa/Johannesburg").format("dddd, MMMM D, YYYY h:mm A"):null}}},et={key:1,class:"text-caption"},tt=["src"],lt={key:0,class:"absolute-full text-subtitle2 flex flex-center"},at=["innerHTML"],it=["title"],nt=["title"];function rt(e,l,t,s,i,a){var d,r;return n(),o("span",{class:E(t.isHeading?"text-h6":"")},[typeof t.header.usageType=="undefined"?(n(),o(b,{key:0},[],64)):!t.isHeading&&!t.hideLabel&&!t.header.usageType.startsWith("relChildren")?(n(),o("div",et,w(t.header.label),1)):g("",!0),typeof t.header.usageType=="undefined"?(n(),o(b,{key:2},[],64)):t.header.usageType.startsWith("relChildren")?(n(),o(b,{key:3},[],64)):t.header.usageType==="readOnlyTimestampType"||t.header.usageType==="timestampType"||t.header.usageType==="timeRangeStart"||t.header.usageType==="timeRangeEnd"?(n(),o(b,{key:4},[O(w(a.formatTimestamp(t.item[t.header.field])),1)],64)):t.header.usageType.startsWith("fileImageType")?(n(),o(b,{key:5},[t.protectImage?(n(),o(b,{key:0},[m(F,{onClick:l[0]||(l[0]=q(u=>i.showImageModel=!0,["stop"])),flat:"",unelevated:"",icon:"image",color:"grey"}),m(L,{modelValue:i.showImageModel,"onUpdate:modelValue":l[1]||(l[1]=u=>i.showImageModel=u)},{default:c(()=>[m(R,{style:{width:"700px","max-width":"calc(-32px + 100vw)"},flat:"",class:"bg-grey-2"},{default:c(()=>[m(P,{class:"q-pa-sm flex flex-center"},{default:c(()=>[I("img",{alt:"Â File not found.",src:`${t.item[t.header.field]}`,style:{"max-width":"100%"}},null,8,tt)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)):(n(),h(R,{key:1,style:{width:"unset","max-width":"unset"},flat:"",class:"bg-grey-2"},{default:c(()=>[m(P,{class:"q-pa-sm"},{default:c(()=>[m(Te,{alt:"File not found.",src:`${t.item[t.header.field]}`},{default:c(()=>[t.item[t.header.field]?g("",!0):(n(),o("div",lt," Oops, no image found! "))]),_:1},8,["src"])]),_:1})]),_:1}))],64)):t.header.usageType.startsWith("htmlField")?(n(),o("div",{key:6,innerHTML:t.item[t.header.field]},null,8,at)):t.header.usageType=="actions"&&!a.disabled()?(n(),o("div",{key:7,onClick:l[4]||(l[4]=q(()=>{},["stop"])),style:x(a.disabled()?"cursor: default;":"")},[m(F,{onClick:l[2]||(l[2]=q(u=>a.editItem(t.item),["stop"])),disable:a.disabled(),color:"grey",icon:"edit",flat:"",size:"sm"},null,8,["disable"]),m(F,{onClick:l[3]||(l[3]=q(u=>a.deleteItem(t.item),["stop"])),disable:a.disabled(),color:"grey",icon:"delete",flat:"",size:"sm"},null,8,["disable"])],4)):t.header.usageType.startsWith("relLookup")?(n(),o("div",{key:8,style:{"min-height":"32px",cursor:"pointer"},onClick:l[5]||(l[5]=q(u=>{var f;return a.clickParent((f=t.item)==null?void 0:f[t.header.field],t.header)},["stop"]))},[(r=(d=t.item)==null?void 0:d[t.header.field])!=null&&r[t.header.meta.lookupDisplayField]?(n(),h(ne,{key:0,class:"q-ma-none"},{default:c(()=>{var u,f,p,y;return[I("div",{title:(f=(u=t.item)==null?void 0:u[t.header.field])==null?void 0:f[t.header.meta.lookupDisplayField],style:{overflow:"hidden"}},w((y=(p=t.item)==null?void 0:p[t.header.field])==null?void 0:y[t.header.meta.lookupDisplayField]),9,it)]}),_:1})):g("",!0)])):(n(),o(b,{key:9},[t.isTag?(n(),o("div",{key:0,onClick:l[6]||(l[6]=q(u=>a.clickParent(t.item),["stop"])),style:{cursor:"pointer"}},[t.isTag?(n(),h(ne,{key:0},{default:c(()=>[O(w(t.item[t.header.field]),1)]),_:1})):g("",!0)])):(n(),o("div",{key:1,title:t.item[t.header.field],style:{overflow:"hidden"}},w(a.truncateStr(t.item[t.header.field])),9,nt))],64))],2)}const H=v($e,[["render",rt],["__file","DatapointForDisplayInner.vue"]]),st={name:"RecordFieldsForDisplayGeneric",components:{DatapointForDisplayInner:H},props:{unClickable:{type:Boolean,default(){return!1}},maxFields:{type:Number,default(){return 999}},item:{type:Object,default(){return{}}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},methods:{deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)},clickRow(e){this.$emit("clickRow",e)}}},dt={key:1},ot={key:1},ut={key:1};function mt(e,l,t,s,i,a){const d=k("DatapointForDisplayInner");return n(),o("div",{style:x(t.unClickable?"":"cursor: pointer"),onClick:l[0]||(l[0]=r=>a.clickRow(t.item)),class:"q-pa-sm"},[(n(!0),o(b,null,D(t.superOptions.headers,(r,u)=>(n(),o(b,null,[r.field!=="id"&&(u<t.maxFields||r.usageType==="actions")&&!r.usageType.startsWith("relChildren")&&(r.usageType!=="actions"||t.superOptions.model.rules.editable(t.item))?(n(),o("div",{key:r.name,class:"q-pa-xs q-mb-sm",style:{"min-height":"1.375rem"}},[u<2?(n(),o(b,{key:0},[t.superOptions.headers[0].value==="id"?(n(),o(b,{key:0},[u===0?(n(),o(b,{key:0},[],64)):(n(),o("div",dt,[m(d,{header:r,item:t.item,superOptions:t.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem},null,8,["header","item","superOptions","onEditItem","onDeleteItem"])]))],64)):(n(),o(b,{key:1},[u===0?(n(),h(d,{key:0,header:r,item:t.item,superOptions:t.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem,isHeading:""},null,8,["header","item","superOptions","onEditItem","onDeleteItem"])):(n(),o("div",ot,[(n(),h(d,{key:u,header:r,item:t.item,superOptions:t.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem},null,8,["header","item","superOptions","onEditItem","onDeleteItem"]))]))],64))],64)):(n(),o("div",ut,[(n(),h(d,{key:u,header:r,item:t.item,superOptions:t.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem},null,8,["header","item","superOptions","onEditItem","onDeleteItem"]))]))])):g("",!0)],64))),256))],4)}const j=v(st,[["render",mt],["__file","RecordFieldsForDisplayGeneric.vue"]]),ct={name:"DatapointForDisplay",components:{RecordFieldsForDisplayGeneric:j,SuperTable:A(()=>N(()=>Promise.resolve().then(()=>z),void 0)),DatapointForDisplayInner:H},props:{header:{type:Object,default(){return null}},protectImage:{type:Boolean,default(){return!1}},hideLabel:{type:Boolean,default(){return!1}},dataPoint:{type:Object,default(){return{}}},item:{type:Object,default(){return{}}},childRelations:{type:Array,default(){return[]}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},computed:{asyncComponent(){return this.dataPoint.type==="component"&&this.dataPoint.componentPath?A(this.dataPoint.componentPath):null},compField(){return this.header?this.header:this.dataPoint.type==="component"||this.dataPoint.type==="function"?{label:this.dataPoint.label}:this.superOptions.headers.find(l=>l.field==this.dataPoint.field)},compRelation(){let e={};return this.compField&&this.isRelChildren(this.compField)&&(e=this.childRelations.find(l=>l.field.name==this.dataPoint.field)),e},label(){return typeof this.dataPoint.label!="undefined"?this.dataPoint.label:this.dataPoint.type==="component"||this.dataPoint.type==="function"?"":this.compField?this.compField.label:""}},methods:{deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)},isRelChildren(e){return(e==null?void 0:e.usageType)&&(e==null?void 0:e.usageType.startsWith("relChildren"))}}},ft={key:0},pt={key:0,class:""},ht={class:"row",style:{"align-items":"center"}},yt={key:0,class:"q-pr-sm"},gt={class:"text-bold",style:{display:"flex","align-items":"center"}},bt=["innerHTML"],kt=["innerHTML"];function It(e,l,t,s,i,a){var r,u;const d=k("DatapointForDisplayInner");return!((r=a.compField)!=null&&r.meta)||!((u=a.compField.meta)!=null&&u.hideField)?(n(),o("div",ft,[t.dataPoint.xOrientation?(n(),o("div",pt,[I("div",ht,[t.dataPoint.hideLabel?g("",!0):(n(),o("div",yt,[I("div",gt,w(a.label)+": ",1)])),I("div",null,[(n(),h(K(t.dataPoint.tag?t.dataPoint.tag:"div"),{class:E(t.dataPoint.class?t.dataPoint.class:""),style:x(t.dataPoint.style?t.dataPoint.style:"")},{default:c(()=>[t.dataPoint.type==="component"?(n(),h(K(a.asyncComponent),{key:0,item:t.item},null,8,["item"])):t.dataPoint.type==="function"?(n(),o("span",{key:1,innerHTML:t.dataPoint.function(t.item)},null,8,bt)):(n(),h(d,{key:2,header:a.compField,item:t.item,superOptions:t.superOptions,hideLabel:"",onEditItem:a.editItem,onDeleteItem:a.deleteItem,protectImage:t.protectImage},null,8,["header","item","superOptions","onEditItem","onDeleteItem","protectImage"]))]),_:1},8,["class","style"]))])])])):(n(),o(b,{key:1},[!t.dataPoint.hideLabel&&!t.hideLabel?(n(),o("div",{key:0,class:"text-bold",style:x(`visibility: ${a.label.length?"visible":"hidden"}`)},w(a.label)+": ",5)):g("",!0),(n(),h(K(t.dataPoint.tag?t.dataPoint.tag:"div"),{class:E(t.dataPoint.class?t.dataPoint.class:""),style:x(t.dataPoint.style?t.dataPoint.style:"")},{default:c(()=>[t.dataPoint.type==="component"?(n(),h(K(a.asyncComponent),{key:0,item:t.item,superOptions:t.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem},null,40,["item","superOptions","onEditItem","onDeleteItem"])):t.dataPoint.type==="function"?(n(),o("span",{key:1,innerHTML:t.dataPoint.function(t.item)},null,8,kt)):(n(),h(d,{key:2,header:a.compField,item:t.item,superOptions:t.superOptions,hideLabel:"",onEditItem:a.editItem,onDeleteItem:a.deleteItem,protectImage:t.protectImage},null,8,["header","item","superOptions","onEditItem","onDeleteItem","protectImage"]))]),_:1},8,["class","style"]))],64))])):g("",!0)}const ke=v(ct,[["render",It],["__file","DatapointForDisplay.vue"]]),_t={name:"RecordFieldsForDisplayCustom",components:{DatapointForDisplay:ke},props:{template:{type:Object,default(){return{}}},item:{type:Object,default(){return{}}},unClickable:{type:Boolean,default(){return!1}},childRelations:{type:Array,default(){return[]}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},computed:{},methods:{colClasses(e=12){e=+e;const l={lg:1,md:1.5,sm:2,xs:4};function t(r){return[1,2,3,4,6,12].reduce((f,p)=>Math.abs(p-r)<Math.abs(f-r)?p:f)}const s=t(e*l.lg),i=t(e*l.md),a=t(e*l.sm),d=t(e*l.xs);return`col-${s} col-lg-${s} col-md-${i} col-sm-${a} col-xs-${d}`},deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)},clickRow(e){this.$emit("clickRow",e)}}},vt={style:{"padding-top":"0.03px"}},Ct={key:1,class:"col-12",style:{overflow:"hidden"}};function wt(e,l,t,s,i,a){var u,f,p;const d=k("RecordFieldsForDisplayCustom",!0),r=k("DatapointForDisplay");return n(),o("div",{style:x(t.unClickable?"":"cursor: pointer"),onClick:l[0]||(l[0]=y=>a.clickRow(t.item)),class:E(a.colClasses(t.template.width?t.template.width:12))},[I("div",vt,[I("div",{class:E(["row",`${t.template.unsetGutters?"":"q-col-gutter-xs"} ${(u=t.template.class)!=null&&u.length?t.template.class:""} `]),style:x(`${(f=t.template.style)!=null&&f.length?t.template.style:""}`)},[(p=t.template.cols)!=null&&p.length?(n(!0),o(b,{key:0},D(t.template.cols,(y,M)=>(n(),h(d,{key:M,template:y,item:t.item,childRelations:t.childRelations,superOptions:t.superOptions,unClickable:t.unClickable,onEditItem:a.editItem,onDeleteItem:a.deleteItem},re({_:2},[D(e.$slots,(V,T)=>({name:T,fn:c(Q=>[Y(e.$slots,T,fe({ref_for:!0},Q))])}))]),1032,["template","item","childRelations","superOptions","unClickable","onEditItem","onDeleteItem"]))),128)):t.template.dataPoint&&(t.template.dataPoint.field!=="actions"||t.superOptions.model.rules.editable(t.item))?(n(),o("div",Ct,[m(r,{item:t.item,dataPoint:t.template.dataPoint,childRelations:t.childRelations,superOptions:t.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem},re({_:2},[D(e.$slots,(y,M)=>({name:M,fn:c(V=>[Y(e.$slots,M,xe(De(V)))])}))]),1032,["item","dataPoint","childRelations","superOptions","onEditItem","onDeleteItem"])])):g("",!0)],6)])],6)}const W=v(_t,[["render",wt],["__file","RecordFieldsForDisplayCustom.vue"]]),Ft={name:"DestructableExpansionPanels",props:{destroy:{type:Boolean,default(){return!1}},title:{type:String,default(){return""}}}},Tt={class:"text-h6"},xt={class:""};function Dt(e,l,t,s,i,a){return n(),o("div",null,[t.destroy?Y(e.$slots,"default",{key:0}):(n(),h(Se,{key:1},{header:c(()=>[I("div",Tt,w(t.title),1)]),default:c(()=>[I("div",xt,[Y(e.$slots,"default")])]),_:3}))])}const Ie=v(Ft,[["render",Dt],["__file","DestructableExpansionPanels.vue"]]),St=A(()=>N(()=>Promise.resolve().then(()=>z),void 0)),Mt={name:"FilterPlace",components:{SuperSelect:be,SuperTable:St},props:{filterField:{type:Object,default:()=>({})},modelValue:{type:Object,default:()=>({})}},data(){return{menu:!1,modelValueRef:{},placeFieldLevelTypes:["relForeignKeyMapExtraRelCountry","relForeignKeyMapExtraRelAdminArea1","relForeignKeyMapExtraRelAdminArea2","relForeignKeyMapExtraRelLocality","relForeignKeyMapExtraRelSublocality"],parentRelationships:{relForeignKeyMapExtraRelCountry:null,relForeignKeyMapExtraRelAdminArea1:"relForeignKeyMapExtraRelCountry",relForeignKeyMapExtraRelAdminArea2:"relForeignKeyMapExtraRelAdminArea1",relForeignKeyMapExtraRelLocality:"relForeignKeyMapExtraRelAdminArea2",relForeignKeyMapExtraRelSublocality:"relForeignKeyMapExtraRelLocality"}}},computed:{displayPlace(){let e="";const l=this.filterField.children;for(let t of this.placeFieldLevelTypes){let s=l.find(i=>i.usageType===t);if(s&&this.modelValueRef[s.name]&&this.modelValueRef[s.name]){let i=this.fetchDisplayNameFromVuex(s.meta.field.parent,this.modelValueRef[s.name]);i&&(e=i)}}return e}},methods:{handleSelectChange(e){const l=this.filterField.children.find(t=>t.name===e);if(l){const t=this.getChildFields(l.usageType);for(let s of t){const i=this.filterField.children.find(a=>a.usageType===s);i&&this.modelValueRef[i.name]&&(this.modelValueRef[i.name]=null)}}},getChildFields(e){const l=this.placeFieldLevelTypes.indexOf(e);return l===-1||l===this.placeFieldLevelTypes.length-1?[]:this.placeFieldLevelTypes.slice(l+1)},fetchDisplayNameFromVuex(e,l){let t="PlaceholderName";return t=e.query().whereId(l).first()[this.title(e).name],t},title(e){return S.computedAttrs(e).find(s=>s.name!=="id")},filterParentName(e){const l=this.parentRelationships[e.usageType];let t=null;if(l){const s=this.filterField.children.find(i=>i.usageType==l);s&&(t=s.name)}return t},getFilters(e){const l=this.filterParentName(e);let t="";e.usageType==="relForeignKeyMapExtraRelAdminArea1"?t=J.mapExtraRelCountry():e.usageType==="relForeignKeyMapExtraRelAdminArea2"?t=J.mapExtraRelAdminArea1():e.usageType==="relForeignKeyMapExtraRelLocality"?t=J.mapExtraRelAdminArea2():e.usageType==="relForeignKeyMapExtraRelSublocality"&&(t=J.mapExtraRelLocality());const s=Object.keys(e.meta.relatedModel.fieldsMetadata).find(a=>e.meta.relatedModel.fieldsMetadata[a].usageType===t);let i={};return this.modelValue[l]&&(i[s]=this.modelValue[l]),i}},watch:{modelValue:{handler(e,l){JSON.stringify(e)!==JSON.stringify(l)&&(this.modelValueRef=JSON.parse(JSON.stringify(e)))},deep:!0},modelValueRef:{handler(e,l){this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.modelValueRef)))},deep:!0}},mounted(){this.modelValueRef=JSON.parse(JSON.stringify(this.modelValue))}},Ot={key:0,class:"q-mt-md"};function Rt(e,l,t,s,i,a){const d=k("SuperTable");return n(),o("div",null,[m(B,{label:"Place Filter",type:"text",modelValue:a.displayPlace,"onUpdate:modelValue":l[0]||(l[0]=r=>a.displayPlace=r),error:!1,"error-message":"",disable:"",filled:"",dense:"",placeholder:"All",class:"FilterPlaceTrigger"},null,8,["modelValue"]),m(pe,{modelValue:i.menu,"onUpdate:modelValue":l[2]||(l[2]=r=>i.menu=r),fit:"",class:"q-pt-none","no-corner":""},{default:c(()=>[m(R,null,{default:c(()=>[m(P,null,{default:c(()=>[(n(!0),o(b,null,D(t.filterField.children,r=>(n(),o(b,{key:r.name},[r.usageType.startsWith("relForeignKeyMapExtraRel")?(n(),o("div",Ot,[typeof i.modelValueRef[r.name]!="undefined"?(n(),h(d,{key:0,allowAll:"",modelField:r,model:r.meta.field.parent,forcedFilters:a.getFilters(r),modelValue:i.modelValueRef[r.name],"onUpdate:modelValue":[u=>i.modelValueRef[r.name]=u,u=>a.handleSelectChange(r.name)],disabled:a.filterParentName(r)&&!i.modelValueRef[a.filterParentName(r)],isForSelectingRelation:!0,hideCreate:"",selectHideBottomSpace:""},null,8,["modelField","model","forcedFilters","modelValue","onUpdate:modelValue","disabled"])):g("",!0)])):g("",!0)],64))),128)),m(F,{color:"primary",class:"q-mt-md",onClick:l[1]||(l[1]=r=>i.menu=!1)},{default:c(()=>[O("OK")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const _e=v(Mt,[["render",Rt],["__file","FilterPlace.vue"]]),Et={name:"FilterTime",props:{modelField:{type:Object,default(){return{}}},modelValue:{type:Object,default:()=>({year:null,month:null,week:null,day:null,range:{start:null,end:null}})}},data(){return{years:this.generateYears(),months:[],weeks:[],days:[],menu:!1}},computed:{displayDate(){if(this.selectedDay)return _(this.selectedDay).format("ddd, MMM D, YYYY");if(this.selectedWeek){const e=_().year(this.selectedYear).month(this.selectedMonth-1).isoWeek(this.selectedWeek).startOf("isoWeek"),l=e.clone().endOf("isoWeek");return e.month()===l.month()?`${e.format("ddd D")} - ${l.format("ddd D, MMM, YYYY")}`:`${e.format("ddd D, MMM")} - ${l.format("ddd D, MMM, YYYY")}`}return this.selectedMonth?_(`${this.selectedYear}-${this.selectedMonth}-01`).format("MMM, YYYY"):this.selectedYear?this.selectedYear.toString():""},selectedYear:{get(){var e,l;return(e=this.modelValue)!=null&&e.year?(l=this.modelValue)==null?void 0:l.year:null},set(e){const l={...this.modelValue,year:e,month:null,week:null,day:null};this.$emit("update:modelValue",{...l,range:this.computeRange(l)}),this.months=this.generateMonths()}},selectedMonth:{get(){var e,l;return(e=this.modelValue)!=null&&e.month?(l=this.modelValue)==null?void 0:l.month:null},set(e){const l={...this.modelValue,month:e,week:null,day:null};this.$emit("update:modelValue",{...l,range:this.computeRange(l)}),this.weeks=this.generateWeeks(this.selectedYear,e)}},selectedWeek:{get(){var e,l;return(e=this.modelValue)!=null&&e.week?(l=this.modelValue)==null?void 0:l.week:null},set(e){const l={...this.modelValue,week:e,day:null};this.$emit("update:modelValue",{...l,range:this.computeRange(l)}),this.days=this.generateDays(this.selectedYear,this.selectedMonth,e)}},selectedDay:{get(){var e,l;return(e=this.modelValue)!=null&&e.day?(l=this.modelValue)==null?void 0:l.day:null},set(e){const l={...this.modelValue,day:e};this.$emit("update:modelValue",{...l,range:this.computeRange(l)})}}},methods:{toggleMenu(){this.menu=!this.menu},computeRange(e){let l,t;return e.day?(l=_(e.day).startOf("day"),t=_(e.day).add(1,"day").startOf("day")):e.week?(l=_().year(e.year).isoWeek(e.week).isoWeekday(1),t=l.clone().endOf("isoWeek")):e.month?(l=_(`${e.year}-${e.month}-01`,"YYYY-MM-DD"),t=l.clone().endOf("month")):e.year&&(l=_(`${e.year}-01-01`,"YYYY-MM-DD"),t=_(`${e.year}-12-31`,"YYYY-MM-DD")),{start:l?l.format("YYYY-MM-DD"):null,end:t?t.format("YYYY-MM-DD"):null}},generateYears(){const e=_().year(),l=[];l.push({label:"All",value:null});for(let t=0;t<10;t++){let s=e-t,i=s;s===e&&(i=`${s} (Current Year)`),l.push({label:i,value:s})}return l},generateMonths(){const e=[];e.push({label:"All",value:null});const l=_().month();for(let t=0;t<12;t++){let s=_().month(t).format("MMMM");t===l&&(s=`${s} (Current Month)`),e.push({label:s,value:+_().month(t).format("MM")})}return e},generateWeeks(e,l){const t=_(`${e}-${l}-01`,"YYYY-MM-DD").startOf("month"),s=t.clone().endOf("month"),i=[];i.push({label:"All",value:null});let a=1;const d=_();for(;t<=s;){const r=t.clone().startOf("isoWeek"),u=r.clone().endOf("isoWeek");let f;r.month()===u.month()?f=`Week ${a} (${r.format("MMM D dd")} - ${u.format("D dd")})`:f=`Week ${a} (${r.format("MMM D dd")} - ${u.format("MMM D dd")})`,d.isBetween(r,u,null,"[]")&&(f=`${f} (Current Week)`),i.push({label:f,value:r.isoWeek()}),t.add(1,"week"),++a}return i},generateDays(e,l,t){const s=t,i=_().year(e).isoWeek(s).isoWeekday(1),a=i.clone().endOf("isoWeek"),d=[],r=_().format("YYYY-MM-DD");for(;i<=a;){let p=i.format("dd, Do");i.format("YYYY-MM-DD")===r&&(p=`${p} (Today)`),d.push({label:p,value:i.format("YYYY-MM-DD")}),i.add(1,"day")}const u=d.filter(p=>+_(p.value).format("MM")===l);return[{label:"All",value:null},...u]}},mounted(){this.filtersData=this.modelValue}};function Vt(e,l,t,s,i,a){return n(),o("div",null,[m(B,{label:"Time Filter",type:"text",modelValue:a.displayDate,"onUpdate:modelValue":l[0]||(l[0]=d=>a.displayDate=d),error:!1,"error-message":"",disable:"",filled:"",dense:"",onClick:a.toggleMenu,class:"FilterTimeTrigger"},null,8,["modelValue","onClick"]),m(pe,{modelValue:i.menu,"onUpdate:modelValue":l[6]||(l[6]=d=>i.menu=d),fit:"",class:"q-pt-none","no-corner":"","close-on-content-click":!1},{default:c(()=>[m(R,null,{default:c(()=>[m(P,null,{default:c(()=>[m(U,{options:i.years,modelValue:a.selectedYear,"onUpdate:modelValue":l[1]||(l[1]=d=>a.selectedYear=d),label:"Year","option-label":"label","option-value":"value",dense:"",filled:"",emitValue:"",mapOptions:"",class:"q-mb-sm"},null,8,["options","modelValue"]),m(U,{options:i.months,modelValue:a.selectedMonth,"onUpdate:modelValue":l[2]||(l[2]=d=>a.selectedMonth=d),label:"Month",disable:!a.selectedYear,"option-label":"label","option-value":"value",dense:"",filled:"",emitValue:"",mapOptions:"",class:"q-mb-sm"},null,8,["options","modelValue","disable"]),m(U,{options:i.weeks,modelValue:a.selectedWeek,"onUpdate:modelValue":l[3]||(l[3]=d=>a.selectedWeek=d),label:"Week",disable:!a.selectedMonth,"option-label":"label","option-value":"value",dense:"",filled:"",emitValue:"",mapOptions:"",class:"q-mb-sm"},null,8,["options","modelValue","disable"]),m(U,{options:i.days,modelValue:a.selectedDay,"onUpdate:modelValue":l[4]||(l[4]=d=>a.selectedDay=d),label:"Day",disable:!a.selectedWeek,"option-label":"label","option-value":"value",dense:"",filled:"",emitValue:"",mapOptions:"",class:"q-mb-sm"},null,8,["options","modelValue","disable"]),m(ae,null,{default:c(()=>[m(Me),m(F,{color:"primary",onClick:l[5]||(l[5]=d=>i.menu=!1)},{default:c(()=>[O("OK")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const ve=v(Et,[["render",Vt],["__file","FilterTime.vue"]]),Pt="data:image/svg+xml,%3csvg%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2043%2043'%20width='43px'%20height='43px'%20%3e%3ccircle%20fill='%23ef3061'%20cx='21.5'%20cy='21.5'%20r='11.5'%20/%3e%3cpath%20d='%20M%2035.988887394336025%2017.617714323462188%20A%2015%2015,%200,%200,%201,%2025.382285676537812%2035.988887394336025%20M%2017.617714323462188%2035.988887394336025%20A%2015%2015,%200,%200,%201,%207.011112605663973%2017.617714323462195%20M%2010.893398282201785%2010.893398282201789%20A%2015%2015,%200,%200,%201,%2032.10660171779821%2010.893398282201785%20'%20stroke='%23ef3061'%20stroke-width='3'%20stroke-linecap='round'%20fill='transparent'%20opacity='0.7'%20/%3e%3cpath%20d='%20M%2041.5%2021.5%20A%2020%2020,%200,%200,%201,%2031.5%2038.82050807568877%20M%2011.500000000000004%2038.82050807568878%20A%2020%2020,%200,%200,%201,%201.5%2021.500000000000004%20M%2011.499999999999991%204.1794919243112325%20A%2020%2020,%200,%200,%201,%2031.5%204.179491924311229%20'%20stroke='%23ef3061'%20stroke-width='3'%20stroke-linecap='round'%20fill='transparent'%20opacity='0.4'%20/%3e%3c/svg%3e",me="data:image/svg+xml,%3csvg%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%20width='24px'%20height='24px'%20className='flex'%20%3e%3cpath%20fill='%23fbfbfb'%20d='M454.848,198.848c0,159.225-179.751,306.689-179.751,306.689c-10.503,8.617-27.692,8.617-38.195,0c0,0-179.751-147.464-179.751-306.689C57.153,89.027,146.18,0,256,0S454.848,89.027,454.848,198.848z'%20/%3e%3cpath%20fill='%23ef3061'%20d='M454.848,198.848c0,159.225-179.751,306.689-179.751,306.689c-10.503,8.617-27.692,8.617-38.195,0c0,0-179.751-147.464-179.751-306.689C57.153,89.027,146.18,0,256,0S454.848,89.027,454.848,198.848z'%20/%3e%3cpath%20fill='%23fbfbfb'%20d='M256,298.89c-55.164,0-100.041-44.879-100.041-100.041S200.838,98.806,256,98.806s100.041,44.879,100.041,100.041S311.164,298.89,256,298.89z'%20/%3e%3c/svg%3e",At={name:"MyGoogleMap",components:{InocanGoogleMap:Oe,InocanMarker:Re,InocanMarkerCluster:Ee},props:{markers:{type:Array,default(){return[]}},modelValue:{type:Object,default(){return{}}},zoom:{type:Number,default(){return 2}}},data(){return{selectedPlaceIndex:null,VITE_API_GOOGLE_MAP_KEY:"AIzaSyAENUjZ_P7ulkAcDb-U8Htn6VSv_ioEKWE",iconAndLabelLabel:{icon:{url:Pt},label:{color:"white"}}}},computed:{clusterStyles(){return[{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40}]}},methods:{iconAndLabelLabelMethod(e){return{icon:this.iconAndLabelLabel.icon,label:{text:String(e),...this.iconAndLabelLabel.label}}},clusterOptions(e){return{renderer:{render:({count:l,position:t})=>new e.Marker({position:t,...this.iconAndLabelLabelMethod(l),zIndex:999+l})}}},markerOptions(e){return{url:me,size:{width:30,height:30,f:"px",b:"px"},scaledSize:{width:30,height:30,f:"px",b:"px"}}},selectedMarkerOptions(e){return{id:e.meta.id,url:me,size:{width:40,height:40,f:"px",b:"px"},scaledSize:{width:40,height:40,f:"px",b:"px"}}},markerOptionsMethod(e,l){return l===this.selectedPlaceIndex?this.selectedMarkerOptions(e):this.markerOptions(e)},position(e){return{lng:Number(e.lng),lat:Number(e.lat)}},clickedMarker(e,l){this.$emit("update:modelValue",e.position),this.selectedPlaceIndex=l,this.$emit("clickMarker",e,l)}}};function Lt(e,l,t,s,i,a){const d=k("InocanMarker"),r=k("InocanMarkerCluster"),u=k("InocanGoogleMap");return n(),o("div",null,[m(u,{"api-key":i.VITE_API_GOOGLE_MAP_KEY,center:t.modelValue,zoom:t.zoom,"map-type-id":"roadmap",style:{height:"calc(100vh - 100px)",width:"100%"}},{default:c(({api:f})=>[m(r,{options:a.clusterOptions(f)},{default:c(()=>[(n(!0),o(b,null,D(t.markers,(p,y)=>(n(),h(d,{key:y,onClick:M=>a.clickedMarker(p,y),options:{position:p.position,icon:a.markerOptionsMethod(p,y)}},null,8,["onClick","options"]))),128))]),_:2},1032,["options"])]),_:1},8,["api-key","center","zoom"])])}const Bt=v(At,[["render",Lt],["__file","MyGoogleMap.vue"]]),Nt={name:"SuperTableGrid",components:{RecordFieldsForDisplayGeneric:j,RecordFieldsForDisplayCustom:W},props:{loading:{type:Boolean,default(){return!1}},excludedCols:{type:Array,default(){return[]}},unClickable:{type:Boolean,default(){return!1}},templateListGrid:{type:Object,default(){return{}}},items:{type:Array,default(){return[]}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},methods:{colClasses(e=12){e=+e;const l={lg:1,md:1.5,sm:2,xs:4};function t(r){return[1,2,3,4,6,12].reduce((f,p)=>Math.abs(p-r)<Math.abs(f-r)?p:f)}const s=t(e*l.lg),i=t(e*l.md),a=t(e*l.sm),d=t(e*l.xs);return`col-${s} col-lg-${s} col-md-${i} col-sm-${a} col-xs-${d}`},deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)},clickRow(e){this.$emit("clickRow",e[this.superOptions.model.primaryKey],e)}}},qt={key:0,class:"text-center q-pa-md"},Kt={key:1,class:"text-center q-pa-md text-grey-5"},Yt={key:1,class:"row q-col-gutter-md justify-center"},jt={class:"q-card q-mx-auto",style:{height:"100%",overflow:"hidden"}},Gt={key:1,class:E("col-12 col-md-3 ")},Ut={class:"q-card q-mx-auto",style:{height:"100%"}};function Ht(e,l,t,s,i,a){const d=k("RecordFieldsForDisplayCustom"),r=k("RecordFieldsForDisplayGeneric");return n(),o("div",null,[t.items.length?(n(),o("div",Yt,[(n(!0),o(b,null,D(t.items,u=>(n(),o(b,{key:u.name},[t.templateListGrid&&t.templateListGrid.cols?(n(),o("div",{key:0,class:E(a.colClasses(t.templateListGrid.colWidth?t.templateListGrid.colWidth:3))},[I("div",jt,[m(d,{item:u,onClickRow:a.clickRow,maxFields:6,childRelations:[],isSummary:"",superOptions:t.superOptions,template:t.templateListGrid,onEditItem:a.editItem,onDeleteItem:a.deleteItem,unClickable:t.unClickable||!t.superOptions.model.rules.readable(u)},null,8,["item","onClickRow","superOptions","template","onEditItem","onDeleteItem","unClickable"])])],2)):(n(),o("div",Gt,[I("div",Ut,[m(r,{item:u,onClickRow:a.clickRow,maxFields:6,superOptions:t.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem,unClickable:t.unClickable},null,8,["item","onClickRow","superOptions","onEditItem","onDeleteItem","unClickable"])])]))],64))),128))])):(n(),o(b,{key:0},[t.loading?(n(),o("div",qt,"Loading...")):(n(),o("div",Kt,"None"))],64))])}const Wt=v(Nt,[["render",Ht],["__file","SuperTableGrid.vue"]]),zt={name:"SuperTableTable",components:{DatapointForDisplay:ke,DatapointForDisplayInner:H},props:{hidePagination:{type:Boolean,default(){return!1}},templateListTable:{type:Object,default(){return{}}},items:{type:Array,default(){return[]}},options:{type:Object,default(){return{}}},itemsLength:{type:Number,default(){return null}},loading:{type:Boolean,default(){return!1}},loadingError:{type:Boolean,default(){return!1}},excludedCols:{type:Array,default(){return[]}},model:{type:[Object,Function],required:!0},displayMapField:{type:Boolean,required:!1},canEdit:{type:Boolean,required:!1}},data(){return{sortBy:[],pagination:{page:1,rowsPerPage:10,sortBy:[],descending:!1}}},computed:{superOptions(){return{headers:this.headers,modelFields:this.modelFields,displayMapField:this.displayMapField,model:this.model,canEdit:this.canEdit}},headers(){return S.SupaerTableHeaders(this.model,this.excludedCols,this.canEdit,this.displayMapField)},modelFields(){return S.computedAttrs(this.model,this.excludedCols)},pKey(){return this.superOptions.model.primaryKey},optionsComputed:{get(){return this.options},set(e){this.$emit("update:options",e)}},flattenedHeaders(){let e=[];if(this.templateListTable.length)for(const l of this.templateListTable){const t=this.superOptions.headers.find(i=>i.field===l.field);let s={};if(typeof t!="undefined")s=t,typeof l.label!="undefined"&&(s.label=l.label),s.userConfig=l;else{let i="";typeof l.label!="undefined"&&!l.hideLabel&&(i=l.label);let a="";typeof l.field!="undefined"&&(a=l.field),s={align:"left",dataType:"attr",field:a,label:i,meta:{},name:a,sortable:!!a.length,usageType:"normal",userConfig:l}}e.push(s)}else for(const l of this.superOptions.headers)if(l.usageType!=="relChildrenNormal"&&(e.push(l),l.headerParentFields))for(const t of l.headerParentFields)t.meta.important&&e.push({...t,userConfig:{}});return e},flattenedHeadersHideMapField(){let e=[];for(const l of this.flattenedHeaders)(!l.meta||!l.meta.hideField)&&(this.superOptions.superOptions||!l.usageType.startsWith("relLookupMapExtra")&&!l.usageType.startsWith("mapExtra"))&&e.push(l);return e}},methods:{tableRowClassFn(e){let l="ccc";return this.model.rules.readable(e.row)&&(l="hhh"),l},updateOptions(e){this.$emit("update:options",e)},deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)},clickRow(e){this.model.rules.readable(e)&&this.$emit("clickRow",e[this.model.primaryKey],e)},onRequest(e){const{page:l,rowsPerPage:t,sortBy:s,descending:i}=e.pagination;this.pagination={...this.pagination,page:l,rowsPerPage:t,sortBy:s,descending:i},this.$emit("update:options",{page:l,rowsPerPage:t,sortBy:s,descending:i})}},watch:{options:{handler(e){var l,t;this.pagination={...this.pagination,page:e.page,rowsPerPage:e.itemsPerPage,sortBy:((l=e.sortBy[0])==null?void 0:l.key)||this.pKey,descending:((t=e.sortBy[0])==null?void 0:t.order)==="desc"||!1}},deep:!0},"editItemData.showModal"(e){e||(this.editItemData.data={})}},mounted(){this.sortBy=[{key:this.pKey,order:"asc"}]}},Qt={key:0},Jt={key:1},Zt={key:0,class:"text-center q-pa-md"},Xt={key:1,class:"text-center q-pa-md text-grey-5"},$t={key:2,class:"text-center q-pa-md text-grey-5"};function el(e,l,t,s,i,a){const d=k("DatapointForDisplay");return n(),o("div",null,[t.items.length?(n(),h(ye,{key:0,"table-row-class-fn":a.tableRowClassFn,class:"qTable",rows:t.items,columns:a.flattenedHeadersHideMapField,"row-key":"id","rows-per-page-options":[10,20,30,50,100],pagination:i.pagination,loading:t.loading,onRequest:a.onRequest,hideBottom:t.hidePagination},{body:c(r=>[m(le,{props:r,onClick:u=>a.clickRow(r.row),"no-hover":!t.model.rules.readable(r.row)},{default:c(()=>[(n(!0),o(b,null,D(a.flattenedHeaders,u=>(n(),h(he,{key:u.field,props:r},{default:c(()=>[u.isChildOf?(n(),o("div",Qt,[m(d,{item:r.row[u.isChildOf.value],superOptions:a.superOptions,childRelations:[],dataPoint:u.userConfig,header:u,hideLabel:"",onEditItem:a.editItem,onDeleteItem:a.deleteItem,protectImage:""},null,8,["item","superOptions","dataPoint","header","onEditItem","onDeleteItem"])])):(n(),o("div",Jt,[m(d,{item:r.row,superOptions:a.superOptions,childRelations:[],dataPoint:u.userConfig,header:u,hideLabel:"",onEditItem:a.editItem,onDeleteItem:a.deleteItem,protectImage:""},null,8,["item","superOptions","dataPoint","header","onEditItem","onDeleteItem"])]))]),_:2},1032,["props"]))),128))]),_:2},1032,["props","onClick","no-hover"])]),_:1},8,["table-row-class-fn","rows","columns","pagination","loading","onRequest","hideBottom"])):g("",!0),t.items.length?g("",!0):(n(),o(b,{key:1},[t.loading?(n(),o("div",Zt,"Loading...")):t.loadingError?(n(),o("div",Xt,"Loading Error")):(n(),o("div",$t,"None"))],64))])}const tl=v(zt,[["render",el],["__scopeId","data-v-ac58d24c"],["__file","SuperTableTable.vue"]]),ll={name:"SuperTableMap",components:{RecordFieldsForDisplayCustom:W,DatapointForDisplayInner:H,MyGoogleMap:Bt,RecordFieldsForDisplayGeneric:j},props:{templateListGrid:{type:Object,default(){return{}}},unClickable:{type:Boolean,default(){return!1}},items:{type:Array,default(){return[]}},mapHeaders:{type:Array,default(){return[]}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},data(){return{locationHasBeenGranted:!1,zoom:2,geolocation:Ve(),center:{lat:0,lng:0},geoLocate:{},selectedPlaceIndex:null,clusterStyle:{textColor:"white",url:"/mapIconCluster.svg",anchorText:[1.5,1]},viewItemData:{showModal:!1,data:{}}}},computed:{clusterStyles(){return[{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40},{...this.clusterStyle,height:40,width:40}]},markers(){let e=[],l=this.mapHeaders.find(s=>s.usageType=="mapExtraGeoLocLong"),t=this.mapHeaders.find(s=>s.usageType=="mapExtraGeoLocLat");if(t&&l)for(const s of this.items)[null,""].includes(s[t.name])||e.push({position:{lat:+s[t.name],lng:+s[l.name]},keys:{long:l.name,lat:t.name},meta:s});else{let s="";for(const i of this.mapHeaders)if(s=i.field,i.headerParentFields&&(l=i.headerParentFields.find(a=>a.usageType=="mapExtraGeoLocLong"),t=i.headerParentFields.find(a=>a.usageType=="mapExtraGeoLocLat"),t&&l))break;if(t&&l)for(const i of this.items)i[t.name]!==null&&e.push({position:{lat:i[s][t.name],lng:i[s][l.name]},keys:{long:l.name,lat:t.name},meta:i})}return e}},methods:{deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)},clickRow(e){this.viewItemData.showModal=!1,this.$emit("clickRow",e[this.superOptions.model.primaryKey],e)},position(e){return{lng:Number(e.lng),lat:Number(e.lat)}},positionString(e){return e.lat+", "+e.lng},markerOptionsMethod(e,l){return l==this.selectedPlaceIndex?this.selectedMarkerOptions(e,l):this.markerOptions(e,l)},clickedMarker(e,l){this.viewItemData.showModal=!0,this.viewItemData.data=e.meta,this.selectedPlaceIndex=l},markerOptions(e){return{id:e.meta.id,url:"/mapIconPin.svg",size:{width:30,height:30,f:"px",b:"px"},scaledSize:{width:30,height:30,f:"px",b:"px"}}},selectedMarkerOptions(e){return{id:e.meta.id,url:"/mapIconPin.svg",size:{width:40,height:40,f:"px",b:"px"},scaledSize:{width:40,height:40,f:"px",b:"px"}}}},mounted(){},watch:{"geolocation.coords.latitude"(){if(!this.locationHasBeenGranted){this.locationHasBeenGranted=!0,this.center={lng:this.geolocation.coords.longitude,lat:this.geolocation.coords.latitude};let e=2;this.geolocation.coords.accuracy<=100||this.geolocation.coords.altitude?e=9:this.geolocation.coords.accuracy<=1e3?e=8:e=7,this.zoom=e}}}},al={key:0,class:"text-center q-pa-md"};function il(e,l,t,s,i,a){const d=k("MyGoogleMap"),r=k("RecordFieldsForDisplayCustom"),u=k("RecordFieldsForDisplayGeneric");return n(),o("div",null,[m(R,{class:"q-pa-xs"},{default:c(()=>[a.markers.length?g("",!0):(n(),o("div",al," None ")),a.markers.length?(n(),h(d,{key:1,markers:a.markers,modelValue:i.center,"onUpdate:modelValue":l[0]||(l[0]=f=>i.center=f),zoom:i.zoom,onClickMarker:a.clickedMarker},null,8,["markers","modelValue","zoom","onClickMarker"])):g("",!0)]),_:1}),m(L,{modelValue:i.viewItemData.showModal,"onUpdate:modelValue":l[1]||(l[1]=f=>i.viewItemData.showModal=f),"max-width":"800px"},{default:c(()=>[m(R,{class:"q-pa-none"},{default:c(()=>[t.templateListGrid&&t.templateListGrid.cols?(n(),h(r,{key:0,item:i.viewItemData.data,maxFields:6,childRelations:[],isSummary:"",superOptions:t.superOptions,template:t.templateListGrid,onEditItem:a.editItem,onDeleteItem:a.deleteItem,unClickable:t.unClickable||!t.superOptions.model.rules.readable(i.viewItemData.data),onClickRow:a.clickRow},null,8,["item","superOptions","template","onEditItem","onDeleteItem","unClickable","onClickRow"])):(n(),h(u,{key:1,item:i.viewItemData.data,maxFields:6,superOptions:t.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem,unClickable:t.unClickable,onClickRow:a.clickRow},null,8,["item","superOptions","onEditItem","onDeleteItem","unClickable","onClickRow"]))]),_:1})]),_:1},8,["modelValue"])])}const nl=v(ll,[["render",il],["__file","SuperTableMap.vue"]]),rl={name:"SuperTableList",components:{RecordFieldsForDisplayCustom:W,DatapointForDisplayInner:H},props:{items:{type:Array,default(){return[]}},modelValue:{type:Number,default:null},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}}},methods:{clickRow(e){this.$emit("update:modelValue",e.id)},deleteItem(e){this.$emit("deleteItem",e)},editItem(e){this.$emit("editItem",e)}},computed:{title(){return this.superOptions.headers.find(e=>e.field!=="id")}}},sl={style:{"max-height":"330px","overflow-y":"scroll"}};function dl(e,l,t,s,i,a){const d=k("DatapointForDisplayInner");return n(),o("div",sl,[m(Pe,{dense:""},{default:c(()=>[m(se,{header:"","model-value":t.modelValue,color:"primary"},{default:c(()=>[(n(!0),o(b,null,D(t.items,(r,u)=>(n(),h(Z,{key:u,value:r.id,onClick:f=>a.clickRow(r)},{default:c(()=>[m(te,null,{default:c(()=>[m(se,null,{default:c(()=>[m(d,{header:a.title,item:r,onEditItem:a.editItem,onDeleteItem:a.deleteItem},null,8,["header","item","onEditItem","onDeleteItem"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1},8,["model-value"])]),_:1})])}const ol=v(rl,[["render",dl],["__file","SuperTableList.vue"]]),ul={__name:"PdfTemplate",props:{items:{type:Array,required:!0},options:{type:{},required:!0}},setup(e,{expose:l}){l();const t=e,s=X(()=>t.items.length===0?[]:Object.keys(t.items[0]).map(r=>({name:r,align:"left",label:r.charAt(0).toUpperCase()+r.slice(1),field:r}))),i=X(()=>t.items),a=de({page:1,rowsPerPage:0}),d={props:t,tableColumns:s,tableRows:i,pagination:a,computed:X,ref:de,defineAsyncComponent:A};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}},ml={style:{},id:"pdfContent"},cl={class:""},fl={key:0,class:"text-center q-pa-md",style:{color:"DimGray"}};function pl(e,l,t,s,i,a){return n(),o("div",ml,[I("div",cl,[s.tableRows.length?g("",!0):(n(),o("div",fl," None ")),m(ye,{separator:"none",rows:s.tableRows,columns:s.tableColumns,"row-key":"key",flat:"",dense:"",pagination:s.pagination,"hide-bottom":""},{header:c(d=>[m(le,{props:d},{default:c(()=>[(n(!0),o(b,null,D(d.cols,r=>(n(),h(Ae,{key:r.name,props:d,class:"table-header"},{default:c(()=>[O(w(r.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:c(d=>[m(le,{props:d},{default:c(()=>[(n(!0),o(b,null,D(d.cols,r=>(n(),h(he,{key:r.name,props:d,class:"table-cell"},{default:c(()=>[O(w(d.row[r.field]),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])])])}const Ce=v(ul,[["render",pl],["__scopeId","data-v-0f231a8a"],["__file","PdfTemplate.vue"]]),hl={props:{events:Array,modelValue:String,view:String,mixedConfigs:Array},data(){return{currentDate:null,currentTime:null,timeStartPos:0,colors:["blue","indigo","deep-purple","cyan","green","orange","grey darken-1"]}},computed:{style(){return{top:this.timeStartPos+"px"}}},methods:{moveToToday(){this.$refs.calendar.moveToToday()},prev(){this.$refs.calendar.prev()},next(){this.$refs.calendar.next()},momentMethod(e,l){return _(e).format(l)},isToday(e){return _(e).isSame(_(),"day")},getEvents(e){return this.events.filter(l=>l.date===e)},showEvent(e){this.$emit("show-event",e)},badgeClasses(e,l){const t=l==="header";return{[`text-white bg-${this.colors[e.configIndex]}`]:!0,"full-width":!t&&(!e.side||e.side==="full"),"left-side":!t&&e.side==="left","right-side":!t&&e.side==="right","rounded-border":!0}},badgeStyles(e,l,t=void 0,s=void 0){const i={};return t&&s&&(i.top=t(e.time)+"px",i.height=s(e.duration)+"px"),i["align-items"]="flex-start",i},hasDate(e){return this.currentDate?e.find(l=>l.date===this.currentDate):!1},adjustCurrentTime(){const e=Le(new Date);this.currentDate=e.date,this.currentTime=e.time,this.timeStartPos=this.$refs.calendar.timeStartPos(this.currentTime,!1)}},mounted(){this.adjustCurrentTime(),setInterval(()=>{this.adjustCurrentTime()},6e4)}},yl={class:"text-center"},gl={class:"text-weight-bold q-mt-xs"},bl={style:{display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"2px"}},kl={class:"title q-calendar__ellipsis"},Il=["onClick"],_l={key:0,class:"title q-calendar__ellipsis"};function vl(e,l,t,s,i,a){const d=k("q-calendar-day");return n(),h(d,{ref:"calendar",modelValue:t.modelValue,"onUpdate:modelValue":l[0]||(l[0]=r=>e.$emit("update:modelValue",r)),view:t.view,"short-weekday-label":"","date-header":"stacked","weekday-align":"center","date-align":"center",bordered:"","interval-height":20,"interval-start":5,"interval-count":19,"hour24-format":"",weekdays:[1,2,3,4,5,6,0],"no-active-date":""},{"head-day":c(({scope:r})=>[I("div",yl,[I("div",gl,w(a.momentMethod(r.timestamp.date,"ddd")),1),m(F,{flat:"",rounded:"",dense:"",style:x([a.isToday(r.timestamp.date)?"border: solid 2px var(--q-primary);":"border: solid 2px rgba(0,0,0,0);",{"font-size":"0.75em"}]),label:a.momentMethod(r.timestamp.date,"D")+" "+a.momentMethod(r.timestamp.date,"MMM"),onClick:u=>e.onClickDate(r.timestamp.date),class:"q-mb-sm text-bold"},null,8,["style","label","onClick"])])]),"day-container":c(({scope:{days:r}})=>[a.hasDate(r)?(n(),o(b,{key:0},[I("div",{class:"day-view-current-time-indicator",style:x(a.style)},null,4),I("div",{class:"day-view-current-time-line",style:x(a.style)},null,4)],64)):g("",!0)]),"head-day-event":c(({scope:{timestamp:r}})=>[I("div",bl,[(n(!0),o(b,null,D(a.getEvents(r.date),u=>(n(),o(b,{key:u.id},[u.time?(n(),h(oe,{key:1,class:E(a.badgeClasses(u,"header")),style:x([a.badgeStyles(u,"header"),{margin:"1px",width:"10px","max-width":"10px",height:"10px","max-height":"10px",cursor:"pointer"}]),onClick:f=>a.showEvent(u)},{default:c(()=>[m(ee,null,{default:c(()=>[O(w(u.time+" - "+u.title),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"])):(n(),h(oe,{key:0,class:E(a.badgeClasses(u,"header")),style:x([a.badgeStyles(u,"header"),{width:"100%",cursor:"pointer",height:"12px","font-size":"10px",margin:"1px"}])},{default:c(()=>[I("div",kl,w(u.title),1)]),_:2},1032,["class","style"]))],64))),128))])]),"day-body":c(({scope:{timestamp:r,timeStartPos:u,timeDurationHeight:f}})=>[(n(!0),o(b,null,D(a.getEvents(r.date),p=>(n(),o(b,{key:p.id},[p.time!==void 0?(n(),o("div",{key:0,onClick:y=>a.showEvent(p),class:E(["my-event",a.badgeClasses(p,"body")]),style:x(a.badgeStyles(p,"body",u,f))},[p.duration>=30?(n(),o("div",_l,w(p.title),1)):g("",!0),m(ee,null,{default:c(()=>[O(w(p.time+" - "+p.title),1)]),_:2},1024)],14,Il)):g("",!0)],64))),128))]),_:1},8,["modelValue","view"])}const Cl=v(hl,[["render",vl],["__file","SuperTableCalendarDay.vue"]]),wl={components:{RecordFieldsForDisplayGeneric:j,RecordFieldsForDisplayCustom:W},props:{events:Array,modelValue:String,view:String,mixedConfigs:Array},methods:{moveToToday(){this.$refs.calendar.moveToToday()},prev(){this.$refs.calendar.prev()},next(){this.$refs.calendar.next()},momentMethod(e,l){return _(e).format(l)},isToday(e){return _(e).isSame(_(),"day")},getEvents(e){return this.events.filter(l=>l.date===e)},showEvent(e){this.$emit("show-event",e)},editItem(e){this.getCurrentConfig(e.configIndex).events.editItem(e)},deleteItem(e){this.getCurrentConfig(e.configIndex).events.deleteItem(e)},getCurrentConfig(e){return this.mixedConfigs[e]},getCurrentTemplate(e){return this.getCurrentConfig(e).templateListCalendar||{}},getCurrentSuperOptions(e){return this.getCurrentConfig(e).superOptions||{}},getCurrentUnClickable(e){return this.getCurrentConfig(e).unClickable||!1}}},Fl={class:"text-center"},Tl={class:"text-weight-bold q-mt-xs"},xl={key:0,class:"text-center q-pa-md text-grey-5"};function Dl(e,l,t,s,i,a){const d=k("RecordFieldsForDisplayCustom"),r=k("RecordFieldsForDisplayGeneric"),u=k("q-calendar-agenda");return n(),h(u,{ref:"calendar","model-value":t.modelValue,"onUpdate:modelValue":l[0]||(l[0]=f=>e.$emit("update:modelValue",f)),view:t.view,weekdays:[1,2,3,4,5,6,0],"short-weekday-label":"","date-header":"stacked","weekday-align":"center","date-align":"center",bordered:"","interval-height":40,"interval-start":5,"interval-count":19,"hour24-format":""},{"head-day":c(({scope:f})=>[I("div",Fl,[I("div",Tl,w(a.momentMethod(f.timestamp.date,"ddd")),1),m(F,{flat:"",rounded:"",dense:"",style:x([a.isToday(f.timestamp.date)?"border: solid 2px var(--q-primary);":"border: solid 2px rgba(0,0,0,0);",{"font-size":"0.75em"}]),label:a.momentMethod(f.timestamp.date,"D")+" "+a.momentMethod(f.timestamp.date,"MMM"),onClick:p=>e.onClickDate(f.timestamp.date),class:"q-mb-sm text-bold"},null,8,["style","label","onClick"])])]),day:c(({scope:{timestamp:f}})=>[a.getEvents(f.date).length?g("",!0):(n(),o("div",xl,"None")),(n(!0),o(b,null,D(a.getEvents(f.date),p=>(n(),h(R,{key:p.id,class:"q-pa-none q-ma-sm",onClick:y=>a.showEvent(p)},{default:c(()=>{var y;return[(y=a.getCurrentTemplate(p.configIndex))!=null&&y.cols?(n(),h(d,{key:0,item:p.meta,maxFields:6,childRelations:[],isSummary:"",superOptions:a.getCurrentSuperOptions(p.configIndex),template:a.getCurrentTemplate(p.configIndex),onEditItem:a.editItem,onDeleteItem:a.deleteItem,unClickable:a.getCurrentUnClickable(p.configIndex)},null,8,["item","superOptions","template","onEditItem","onDeleteItem","unClickable"])):(n(),h(r,{key:1,item:p.meta,maxFields:6,superOptions:a.getCurrentSuperOptions(p.configIndex),onEditItem:a.editItem,onDeleteItem:a.deleteItem,unClickable:a.getCurrentUnClickable(p.configIndex)},null,8,["item","superOptions","onEditItem","onDeleteItem","unClickable"]))]}),_:2},1032,["onClick"]))),128))]),_:1},8,["model-value","view"])}const Sl=v(wl,[["render",Dl],["__file","SuperTableCalendarAgenda.vue"]]),Ml={};function Ol(e,l){return n(),o("div",null,[m(F,{class:"button",onClick:l[0]||(l[0]=t=>e.$emit("today")),unelevated:"",color:"grey-3","text-color":"grey-8"},{default:c(()=>[O(" Today ")]),_:1}),m(F,{"no-caps":"",class:"button",onClick:l[1]||(l[1]=t=>e.$emit("prev")),unelevated:"",icon:"arrow_left"}),m(F,{"no-caps":"",class:"button",onClick:l[2]||(l[2]=t=>e.$emit("next")),unelevated:"","icon-right":"arrow_right"})])}const Rl=v(Ml,[["render",Ol],["__file","CalendarNavigationBar.vue"]]),El={name:"SuperCalendar",components:{SuperTableCalendarDay:Cl,SuperTableCalendarAgenda:Sl,CalendarNavigationBar:Rl,RecordFieldsForDisplayCustom:W,RecordFieldsForDisplayGeneric:j},props:{loading:{type:Boolean,default:!1},mixedConfigs:{type:Array,required:!0}},data(){return{calendarMode:"List",selectedDate:_().format("YYYY-MM-DD"),view:"week",viewItemData:{showModal:!1,data:{},configIndex:null}}},computed:{activeItemAndType(){return this.mixedConfigs[this.viewItemData.configIndex]||{}},firstNonIdKeys(){const e={};return this.mixedConfigs.forEach((l,t)=>{let s=Object.keys(l.superOptions.headers).find(d=>l.superOptions.headers[d].name!=="id"),i=l.superOptions.headers[s].name;if(!l.superOptions.headers.find(d=>d.usageType=="timeRangeStart")){for(const d of l.superOptions.headers)if(d.headerParentFields&&d.headerParentFields.find(u=>u.usageType=="timeRangeStart")){const u=S.SupaerTableHeaders(d.meta.relatedModel,[],[],[]),f=Object.keys(u).find(p=>u[p].name!=="id");i=[d.name,u[f].name]}}e[t]=i}),e},combinedEvents(){const e=[];return this.mixedConfigs.forEach((l,t)=>{const s=this.firstNonIdKeys[t];l.items.forEach(i=>{let a,d;const r=l.startFieldName.split("."),u=l.endFieldName.split(".");r.length>1?(a=new Date(i[r[0]][r[1]]),d=new Date(i[u[0]][u[1]])):(a=new Date(i[r[0]]),d=new Date(i[u[0]]));const f=a.toISOString().split("T")[0],p=a.toISOString().substr(11,5),y=(d-a)/1e3/60,M=Math.max(y,15),V=Array.isArray(s)?i[s[0]][s[1]]:i[s]||"Untitled Event",T={id:i.id||`${f}-${t}-${V}`,title:V,date:f,time:p,duration:M,bgcolor:"deep-purple",icon:"fas fa-calendar-alt",meta:i,configIndex:t};e.push(T)})}),e}},methods:{onShowEvent(e){this.viewItemData={showModal:!0,data:e.meta,configIndex:e.configIndex}},onEditItem(e){this.activeItemAndType.events.editItem(e.meta)},onDeleteItem(e){this.activeItemAndType.events.deleteItem(e.meta)},onToday(){this.$refs.calendarAgenda?this.$refs.calendarAgenda.moveToToday():this.$refs.calendar&&this.$refs.calendar.moveToToday()},onPrev(){this.$refs.calendarAgenda?this.$refs.calendarAgenda.prev():this.$refs.calendar&&this.$refs.calendar.prev()},onNext(){this.$refs.calendarAgenda?this.$refs.calendarAgenda.next():this.$refs.calendar&&this.$refs.calendar.next()}},mounted(){window.innerWidth<768&&(this.view="day")}},Vl={key:0,class:"text-center q-pa-md"},Pl={class:"row items-center wrap q-pb-sm"},Al={class:"q-ml-md"},Ll={style:{display:"flex","max-width":"100%",width:"100%"}};function Bl(e,l,t,s,i,a){const d=k("CalendarNavigationBar"),r=k("SuperTableCalendarDay"),u=k("SuperTableCalendarAgenda"),f=k("RecordFieldsForDisplayCustom"),p=k("RecordFieldsForDisplayGeneric");return n(),o("div",null,[t.loading?(n(),o("div",Vl,"Loading...")):g("",!0),I("div",{style:x(`display: ${t.loading?"none":"block"};`)},[I("div",Pl,[m(Be,{label:"Time Grid",modelValue:i.calendarMode,"onUpdate:modelValue":l[0]||(l[0]=y=>i.calendarMode=y),"toggle-color":"primary","false-value":"List","true-value":"Timeline",unelevated:"","text-color":"grey-8"},null,8,["modelValue"]),I("div",Al,[m(d,{onToday:a.onToday,onPrev:a.onPrev,onNext:a.onNext},null,8,["onToday","onPrev","onNext"])])]),I("div",Ll,[i.calendarMode==="Timeline"?(n(),h(r,{key:0,ref:"calendar",events:a.combinedEvents,mixedConfigs:t.mixedConfigs,modelValue:i.selectedDate,"onUpdate:modelValue":l[1]||(l[1]=y=>i.selectedDate=y),view:i.view,onShowEvent:a.onShowEvent,onEditItem:a.onEditItem,onDeleteItem:a.onDeleteItem},null,8,["events","mixedConfigs","modelValue","view","onShowEvent","onEditItem","onDeleteItem"])):(n(),h(u,{key:1,ref:"calendarAgenda",events:a.combinedEvents,mixedConfigs:t.mixedConfigs,modelValue:i.selectedDate,"onUpdate:modelValue":l[2]||(l[2]=y=>i.selectedDate=y),view:i.view,onShowEvent:a.onShowEvent,onEditItem:a.onEditItem,onDeleteItem:a.onDeleteItem},null,8,["events","mixedConfigs","modelValue","view","onShowEvent","onEditItem","onDeleteItem"]))])],4),m(L,{modelValue:i.viewItemData.showModal,"onUpdate:modelValue":l[9]||(l[9]=y=>i.viewItemData.showModal=y),"max-width":"800px"},{default:c(()=>[m(R,{class:"q-pa-none",style:{width:"700px","max-width":"calc(100vw - 32px)"}},{default:c(()=>[a.activeItemAndType.templateListGrid&&a.activeItemAndType.templateListGrid.cols?(n(),h(f,{key:0,item:i.viewItemData.data,maxFields:6,childRelations:[],isSummary:"",superOptions:a.activeItemAndType.superOptions,template:a.activeItemAndType.templateListGrid,onEditItem:l[3]||(l[3]=y=>{e.$emit("editItem",y,this.viewItemData.configIndex)}),onDeleteItem:l[4]||(l[4]=y=>{e.$emit("deleteItem",y,this.viewItemData.configIndex)}),onClickRow:l[5]||(l[5]=y=>{e.$emit("clickRow",null,y,this.viewItemData.configIndex)}),unClickable:a.activeItemAndType.unClickable},null,8,["item","superOptions","template","unClickable"])):(n(),h(p,{key:1,item:i.viewItemData.data,maxFields:6,superOptions:a.activeItemAndType.superOptions,onEditItem:l[6]||(l[6]=y=>{e.$emit("editItem",y,this.viewItemData.configIndex)}),onDeleteItem:l[7]||(l[7]=y=>{e.$emit("deleteItem",y,this.viewItemData.configIndex)}),onClickRow:l[8]||(l[8]=y=>{e.$emit("clickRow",null,y,this.viewItemData.configIndex)}),unClickable:a.activeItemAndType.unClickable},null,8,["item","superOptions","unClickable"]))]),_:1})]),_:1},8,["modelValue"])])}const Nl=v(El,[["render",Bl],["__file","SuperCalendar.vue"]]),ql=A(()=>N(()=>import("./CreateEditForm.js"),__vite__mapDeps([0,1,2,3,4]))),Kl={name:"CrudModal",components:{CreateEditForm:ql},props:{canEdit:!1,superOptions:{},parentKeyValuePair:{},templateForm:{}},data(){return{submitting:!1,formServerErrors:{},deleteItemData:{showModal:!1,data:null},editItemData:{showModal:!1,data:null},createItemData:{showModal:!1,data:{}}}},methods:{createNewInstance(){return new this.superOptions.model},createItem(){this.createItemData.showModal=!0},createItemSubmit(){if(this.submitting)return;this.submitting=!0;let e=S.preparePayload(this.createItemData.data,this.superOptions.modelFields);delete e.id;let l={};this.superOptions.modelFields.find(s=>s.usageType=="fileImageType")&&(l={"Content-Type":"multipart/form-data"}),this.superOptions.model.Store({...e,...this.createPayloadExtras},[],{},l).then(s=>{var i;(i=this.superOptions.model.hooks)!=null&&i.createComplete&&this.superOptions.model.hooks.createComplete(s),this.submitting=!1,this.$emit("fetchData"),this.$emit("createdItem",s.response.data.data),this.createItemData.data={},this.createItemData.showModal=!1,this.formServerErrors={}}).catch(s=>{this.submitting=!1,this.formServerErrors=s.response.data})},deleteItem(e){this.$emit("deleteItem",e),this.deleteItemData.data=e,this.deleteItemData.showModal=!0},deleteItemSubmit(){this.superOptions.model.Delete(this.deleteItemData.data.id).then(()=>{this.$emit("fetchData"),this.deleteItemData.showModal=!1,this.$emit("deleteComplete")}).catch(e=>{this.$emit("deleteComplete")})},editItem(e){this.$emit("editItem",e),this.editItemData.data={...e},this.editItemData.showModal=!0},editItemSubmit(){const e=S.preparePayload(this.editItemData.data,this.superOptions.modelFields);this.superOptions.model.Update(e,[],{},{"Content-Type":"multipart/form-data"}).then(()=>{this.$emit("fetchData"),this.editItemData.showModal=!1,this.formServerErrors={},this.$emit("editComplete")}).catch(l=>{this.formServerErrors=l.response.data,this.$emit("editComplete")})}},watch:{"createItemData.showModal"(e){e&&(this.createItemData.data=this.createNewInstance(),this.parentKeyValuePair.parentFKey&&this.parentKeyValuePair.parentFVal&&(this.createItemData.data[this.parentKeyValuePair.parentFKey]=this.parentKeyValuePair.parentFVal))}}},Yl=I("div",{class:"text-h6"},"Delete Item",-1),jl=I("p",null,"Are you sure you want to delete this item?",-1);function Gl(e,l,t,s,i,a){const d=k("CreateEditForm");return n(),o("div",null,[t.superOptions.canEdit?(n(),o(b,{key:0},[m(L,{modelValue:i.createItemData.showModal,"onUpdate:modelValue":[l[2]||(l[2]=r=>i.createItemData.showModal=r),l[3]||(l[3]=r=>{i.formServerErrors={}})]},{default:c(()=>[i.createItemData.showModal?(n(),h(d,{key:0,titlePrefix:"New",modelValue:i.createItemData.data,"onUpdate:modelValue":l[0]||(l[0]=r=>i.createItemData.data=r),onSubmit:a.createItemSubmit,onCancel:l[1]||(l[1]=r=>{i.createItemData.showModal=!1,i.formServerErrors={}}),superOptions:t.superOptions,style:{width:"700px","max-width":"calc(-32px + 100vw)"},template:t.templateForm,formServerErrors:i.formServerErrors,submitting:i.submitting},null,8,["modelValue","onSubmit","superOptions","template","formServerErrors","submitting"])):g("",!0)]),_:1},8,["modelValue"]),t.superOptions.canEdit?(n(),o(b,{key:0},[m(L,{modelValue:i.editItemData.showModal,"onUpdate:modelValue":[l[6]||(l[6]=r=>i.editItemData.showModal=r),l[7]||(l[7]=r=>{i.formServerErrors={}})]},{default:c(()=>[i.editItemData.showModal?(n(),h(d,{key:0,titlePrefix:"Edit",modelValue:i.editItemData.data,"onUpdate:modelValue":l[4]||(l[4]=r=>i.editItemData.data=r),onSubmit:a.editItemSubmit,onCancel:l[5]||(l[5]=r=>{i.editItemData.showModal=!1,i.formServerErrors={}}),superOptions:t.superOptions,template:t.templateForm,style:{width:"700px","max-width":"calc(-32px + 100vw)"},formServerErrors:i.formServerErrors,submitting:i.submitting},null,8,["modelValue","onSubmit","superOptions","template","formServerErrors","submitting"])):g("",!0)]),_:1},8,["modelValue"]),m(L,{modelValue:i.deleteItemData.showModal,"onUpdate:modelValue":l[9]||(l[9]=r=>i.deleteItemData.showModal=r)},{default:c(()=>[m(R,{style:{width:"500px","max-width":"calc(-32px + 100vw)"}},{default:c(()=>[m(P,{class:"q-pt-md q-pb-md q-pl-md q-pr-md"},{default:c(()=>[Yl]),_:1}),m(P,null,{default:c(()=>[jl]),_:1}),m(ae,{align:"right"},{default:c(()=>[m(F,{onClick:l[8]||(l[8]=r=>i.deleteItemData.showModal=!1),flat:""},{default:c(()=>[O("Cancel")]),_:1}),m(F,{onClick:a.deleteItemSubmit,color:"negative",flat:""},{default:c(()=>[O("Delete")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)):g("",!0)],64)):g("",!0)])}const Ul=v(Kl,[["render",Gl],["__file","CrudModal.vue"]]),Hl=A(()=>N(()=>Promise.resolve().then(()=>z),void 0)),Wl={name:"SuperTableTopBar",components:{PdfTemplate:Ce,CreateButton:ge,DestructableExpansionPanels:Ie,FilterTime:ve,SuperTable:Hl,FilterPlace:_e},props:{templateForm:{type:Object,default(){return{}}},createButtonText:{type:String,default:""},allowedFilters:{type:Array,default:null},noBorder:{type:Boolean,default:!1},modelValue:{type:Object,default:{}},downloadables:{type:Object,default:{}},templateListTable:{type:Object,default:{}},canCreateComputed:{type:Boolean,default:!1},canEdit:{type:Boolean,default:!1},isForSelectingRelation:{type:Boolean,default:!1},hideCreate:{type:Boolean,default:!1},startFieldName:{type:String,default:""},activeTab:{type:String,default:""},search:{type:String,default:""},longField:{type:Object,default:{}},superOptions:{type:Object,default(){return{headers:[],modelFields:[],displayMapField:!1,model:{},canEdit:!1,currentParentRecord:{}}}},viewAs:{type:Object,default(){return{show:["table","grid","map","calendar"],default:"table"}}}},data(){return{activeTabRef:"",searchRef:"",modelValueRef:{}}},computed:{flattenedHeaders(){let e=[];if(this.templateListTable.length)for(const l of this.templateListTable){const t=this.superOptions.headers.find(i=>i.field===l.field);let s={};if(typeof t!="undefined")s=t,typeof l.label!="undefined"&&(s.label=l.label),s.userConfig=l;else{let i="";typeof l.label!="undefined"&&!l.hideLabel&&(i=l.label);let a="";typeof l.field!="undefined"&&(a=l.field),s={align:"left",dataType:"attr",field:a,label:i,meta:{},name:a,sortable:!!a.length,usageType:"normal",userConfig:l}}e.push(s)}else for(const l of this.superOptions.headers)if(e.push(l),l.headerParentFields)for(const t of l.headerParentFields)e.push({...t,userConfig:{}});return e},quickListsIsMobile(){return S.quickListsIsMobile()},tabOptions(){let e=[];return this.viewAs.show.includes("grid")&&e.push({label:"Grid",value:"grid",icon:"grid_view"}),this.viewAs.show.includes("map")&&this.longField&&e.push({label:"Map",value:"map",icon:"map"}),this.viewAs.show.includes("calendar")&&this.startFieldName&&e.push({label:"Calendar",value:"calendar",icon:"calendar_today"}),this.viewAs.show.includes("table")&&e.push({label:"Table",value:"table"}),e},itemsForExport(){var t,s;const e=[];let l={};for(const i of this.items){l={};for(const a of this.flattenedHeaders)a.userConfig&&a.userConfig.type==="function"?l[a.label]=a.userConfig.function(i):a.usageType&&(a.usageType==="readOnlyTimestampType"||a.usageType==="timestampType"||a.usageType==="timeRangeStart"||a.usageType==="timeRangeEnd"?l[a.label]=this.formatTimestamp(i[a.field]):a.usageType.startsWith("relLookup")?(t=i==null?void 0:i[a.field])!=null&&t[a.meta.lookupDisplayField]&&(l[a.label]=(s=i==null?void 0:i[a.field])==null?void 0:s[a.meta.lookupDisplayField]):!a.usageType.startsWith("relChildren")&&i[a.field]&&(l[a.label]=this.truncateStr(i[a.field])));e.push(l)}return e},filterInputs(){const e=this.superOptions.modelFields,l=[];for(const t of e)if(t.usageType.startsWith("relForeignKeyNormal")||t.usageType=="timeRangeStart")l.push(t);else if(t.usageType=="relForeignKeyMapExtraRelSublocality"){const s=e.filter(i=>i.usageType.startsWith("relForeignKeyMapExtraRel"));l.push({label:"Place",name:"Place",usageType:"mapFilter",dataType:"normal",children:s})}return l}},methods:{toHtmlIdSafeString(e){return e.toString().toLowerCase().trim().replace(/\s+/g,"-").replace(/[^a-z0-9_-]/g,"").replace(/^-+/,"")},createItem(e){this.$emit("createItem",e)},formatTimestamp(e){return e?_.tz(e,"YYYY-MM-DDTHH:mm:ss.SSSSSSZ","UTC").tz("Africa/Johannesburg").format("dddd, MMMM D, YYYY h:mm A"):null},convertToCsv(){if(this.itemsForExport.length===0)return"";const e=Object.keys(this.itemsForExport[0]).join(","),l=this.itemsForExport.map(t=>Object.values(t).map(s=>`"${s}"`).join(","));return[e,...l].join(`\r
`)},truncateStr(e){let l="";return e&&(l=e.length>40?e.substring(0,40)+"...":e),l},defineAsyncComponent:A,downloadCsv(){var s;const e=this.convertToCsv(),l=new Blob([e],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a");t.href=URL.createObjectURL(l),t.setAttribute("download",`${(s=this.downloadables.csv)==null?void 0:s.title}.csv`),document.body.appendChild(t),t.click(),document.body.removeChild(t)},downloadPdf(){var s,i,a,d;const e=document.querySelector(`#pdfBody${this.toHtmlIdSafeString((s=this.downloadables.pdf)==null?void 0:s.title)}`),l=document.querySelector(`#pdfHeader${this.toHtmlIdSafeString((i=this.downloadables.pdf)==null?void 0:i.title)}`),t=document.querySelector(`#pdfFooter${this.toHtmlIdSafeString((a=this.downloadables.pdf)==null?void 0:a.title)}`);S.downloadPdf((d=this.downloadables.pdf)==null?void 0:d.title,e,this.downloadables.pdf.margin?this.downloadables.pdf.margin:0,t,l)},shouldWeShowTopBar(){let e=!1;return(this.viewAs.show.length||this.filterInputs.length&&(this.allowedFilters==null||this.filterInputs.some(l=>this.allowedFilters.includes(l.name)))||this.superOptions.model.titleKey!==this.superOptions.model.primaryKey||Object.keys(this.downloadables).includes("csv")||Object.keys(this.downloadables).includes("pdf")||this.canCreateComputed&&this.canEdit&&!this.hideCreate&&!this.isForSelectingRelation)&&(e=!0),e}},watch:{modelValue:{handler(e,l){JSON.stringify(e)!==JSON.stringify(l)&&(this.modelValueRef={...e})},deep:!0},modelValueRef:{handler(e,l){this.$emit("update:modelValue",this.modelValueRef)},deep:!0},activeTab:{handler(e,l){JSON.stringify(e)!==JSON.stringify(l)&&(this.activeTabRef=e)}},activeTabRef:{handler(e,l){JSON.stringify(e)!==JSON.stringify(l)&&this.$emit("update:activeTab",this.activeTabRef)}},search:{handler(e,l){JSON.stringify(e)!==JSON.stringify(l)&&(this.searchRef=e)}},searchRef:{handler(e,l){JSON.stringify(e)!==JSON.stringify(l)&&this.$emit("update:search",e)}}},mounted(){this.modelValueRef={...this.modelValue},this.activeTabRef=this.activeTab,this.searchRef=this.search;for(const e of this.superOptions.modelFields)e.usageType.startsWith("relForeignKey")||e.dataType.startsWith("mapExtraRel")?this.modelValueRef[e.name]=null:e.usageType=="timeRangeStart"&&(this.modelValueRef[e.name]=null)}},zl={class:"row items-center wrap"},Ql={key:0,style:{"margin-bottom":"20px"},class:"q-mr-sm"},Jl={key:1,class:"q-mr-sm"},Zl={key:0,style:{"min-width":"200px"}},Xl={style:{display:"none"}},$l=["id"],ea=["id"];function ta(e,l,t,s,i,a){const d=k("CreateButton"),r=k("SuperTable"),u=k("FilterTime"),f=k("FilterPlace"),p=k("PdfTemplate"),y=k("DestructableExpansionPanels");return n(),o("div",null,[a.shouldWeShowTopBar()?(n(),o("div",{key:0,class:E(t.noBorder?"q-mx-md":"")},[m(y,{destroy:!a.quickListsIsMobile,title:"Settings"},{default:c(()=>{var M,V,T,Q,ie;return[I("div",zl,[t.canCreateComputed&&t.canEdit&&!t.hideCreate&&!t.isForSelectingRelation?(n(),o("div",Ql,[e.$slots.create?Y(e.$slots,"create",{key:0}):(n(),o(b,{key:1},[t.superOptions.model.rules.creatable()?(n(),h(d,{key:0,modelFields:t.superOptions.modelFields,onCreateItem:a.createItem,model:t.superOptions.model,superOptions:t.superOptions,template:t.templateForm,createButtonText:t.createButtonText},null,8,["modelFields","onCreateItem","model","superOptions","template","createButtonText"])):g("",!0)],64))])):g("",!0),t.viewAs.show.length?(n(),o("div",Jl,[m(Ne,{modelValue:i.activeTabRef,"onUpdate:modelValue":l[0]||(l[0]=C=>i.activeTabRef=C),"toggle-color":"primary",options:a.tabOptions,style:{"margin-bottom":"20px"},unelevated:"","text-color":"grey-8",color:"grey-3"},null,8,["modelValue","options"])])):g("",!0),(n(!0),o(b,null,D(a.filterInputs,C=>(n(),o(b,{key:C.name},[typeof i.modelValueRef[C.name]!="undefined"&&(t.allowedFilters==null||t.allowedFilters.includes(C.name))?(n(),o(b,{key:0},[C.usageType.startsWith("relForeignKey")?(n(),o("div",Zl,[m(r,{isForSelectingRelation:!0,canEdit:!1,modelValue:i.modelValueRef[C.name],"onUpdate:modelValue":G=>i.modelValueRef[C.name]=G,model:C.meta.field.parent,rules:[()=>!0],modelField:C,class:"q-mr-sm"},null,8,["modelValue","onUpdate:modelValue","model","modelField"])])):g("",!0),C.usageType=="timeRangeStart"?(n(),h(u,{key:C.name,modelField:C,modelValue:i.modelValueRef[C.name],"onUpdate:modelValue":G=>i.modelValueRef[C.name]=G,class:"q-mr-sm col-grow",style:{"max-width":"200px"}},null,8,["modelField","modelValue","onUpdate:modelValue"])):g("",!0)],64)):(n(),o(b,{key:1},[C.usageType=="mapFilter"?(n(),h(f,{key:C.name,filterField:C,modelValue:i.modelValueRef,"onUpdate:modelValue":l[1]||(l[1]=G=>i.modelValueRef=G),class:"q-mr-sm col-grow",style:{"max-width":"200px"}},null,8,["filterField","modelValue"])):g("",!0)],64))],64))),128)),this.superOptions.model.titleKey!==this.superOptions.model.primaryKey?(n(),h(B,{key:2,modelValue:i.searchRef,"onUpdate:modelValue":l[2]||(l[2]=C=>i.searchRef=C),error:!1,"error-message":"",label:"Search",dense:"",filled:""},null,8,["modelValue"])):g("",!0),Object.keys(t.downloadables).includes("csv")?(n(),h(F,{key:3,icon:"download",label:"CSV",onClick:a.downloadCsv,class:"q-mb-md q-ml-md text-grey-8",filled:"",unelevated:"",style:{backgroundColor:"var(--q-color-grey-2)","margin-left":"auto"}},null,8,["onClick"])):g("",!0),Object.keys(t.downloadables).includes("pdf")?(n(),o(b,{key:4},[m(F,{icon:"download",label:"Pdf",onClick:l[3]||(l[3]=C=>a.downloadPdf()),class:"q-mb-md q-ml-md text-grey-8",filled:"",unelevated:"",style:{backgroundColor:"var(--q-color-grey-2)"}}),I("div",Xl,[m(p,{id:`pdfBody${a.toHtmlIdSafeString((M=t.downloadables.pdf)==null?void 0:M.title)}`,options:t.downloadables.pdf,items:a.itemsForExport},null,8,["id","options","items"]),t.downloadables.pdf.header?(n(),o("div",{key:0,id:`pdfHeader${a.toHtmlIdSafeString((V=t.downloadables.pdf)==null?void 0:V.title)}`},[(n(),h(K(a.defineAsyncComponent((T=t.downloadables.pdf)==null?void 0:T.header))))],8,$l)):g("",!0),t.downloadables.pdf.footer?(n(),o("div",{key:1,id:`pdfFooter${a.toHtmlIdSafeString((Q=t.downloadables.pdf)==null?void 0:Q.title)}`},[(n(),h(K(a.defineAsyncComponent((ie=t.downloadables.pdf)==null?void 0:ie.footer))))],8,ea)):g("",!0)])],64)):g("",!0)])]}),_:3},8,["destroy"])],2)):g("",!0)])}const la=v(Wl,[["render",ta],["__file","SuperTableTopBar.vue"]]),aa=A(()=>N(()=>import("./CreateEditForm.js"),__vite__mapDeps([0,1,2,3,4]))),ia=A(()=>N(()=>Promise.resolve().then(()=>z),void 0)),na={name:"SuperTable",components:{SuperTableTopBar:la,CrudModal:Ul,SuperCalendar:Nl,PdfTemplate:Ce,SearchGooglePlace:Qe,RecordFieldsForDisplayGeneric:j,RelationComponent:Ue,CreateButton:ge,DestructableExpansionPanels:Ie,FilterPlace:_e,FilterTime:ve,SuperSelect:be,SuperTableList:ol,SuperTableMap:nl,SuperTableTable:tl,SuperTableGrid:Wt,CreateEditForm:aa,SuperTable:ia},props:{downloadables:{type:Object,default:{}},noBorder:{type:Boolean,default:!1},justCreateButton:{type:Boolean,default:!1},createButtonText:{type:String,default:""},disabled:{type:Boolean,default:!1},allowedFilters:{type:Array,default:null},allowAll:{type:Boolean,default:!1},hideLabel:{type:Boolean,default(){return!1}},templateForm:{type:Object,default(){return{}}},viewAs:{type:Object,default(){return{show:["table","grid","map","calendar"],default:"table"}}},hideCreate:{type:Boolean,default(){return!1}},forcedFilters:{type:Object,default(){return{}}},templateListTable:{type:Object,default(){return{}}},templateListGrid:{type:Object,default(){return{}}},templateListCalendar:{type:Object,default(){return{}}},model:{type:[Object,Function],required:!0},hidePagination:{type:Boolean,default(){return!1}},displayMapField:{type:Boolean,default(){return!1}},isForSelectingRelation:{type:Boolean,default(){return!1}},modelValue:{type:[Number,Object,String],default(){return null}},showMap:{type:Boolean,default(){return!1}},unClickable:{type:Boolean,default(){return!1}},parentKeyValuePair:{type:Object,default(){return{}}},createPayloadExtras:{type:Object,default(){return{}}},relationships:{type:Array,default(){return[]}},fetchFlags:{type:Object,default(){return{}}},defaultViewModeProp:{type:String,default(){return""}},rules:{type:Array,default(){return[()=>!0]}},modelField:{type:Object,default:()=>({})},errorMessage:{type:String,default(){return null}},selectHideBottomSpace:{type:Boolean,default(){return!1}}},data(){return{loadingError:!1,search:"",years:Array.from({length:5},(e,l)=>new Date().getFullYear()-l),itemsLength:1,activated:!1,loading:!1,options:{page:1,itemsPerPage:10,sortBy:[],groupBy:[]},highlightedRow:null,filters:{},items:[],activeTab:""}},computed:{longField(){return this.mapHeaders.find(l=>l.usageType=="mapExtraGeoLocLong")},startFieldName(){return ue.getFieldFromModelOrParent(this.superOptions.headers,"timeRangeStart")},endFieldName(){return ue.getFieldFromModelOrParent(this.superOptions.headers,"timeRangeEnd")},parentField(){return this.superOptions.modelFields.find(l=>l.name==this.parentKeyValuePair.parentFKey)},canCreateComputed(){if(this.parentField&&typeof this.parentField.fieldExtras.linkablesRule=="function"){const e=this.parentField.fieldExtras.linkablesRule();if(e[this.model.primaryKey]&&this.parentKeyValuePair.parentFVal&&!e[this.model.primaryKey].split(",").map(Number).includes(this.parentKeyValuePair.parentFVal))return!1}return!0},superOptions(){return{headers:this.headers,modelFields:this.modelFields,displayMapField:this.displayMapField,model:this.model,canEdit:this.canEdit}},excludedCols(){let e=[];return this.parentKeyValuePair.parentFKey&&(e=[this.parentKeyValuePair.parentFKey]),e},canEdit(){return this.model.rules.creatable()},filtersComp(){const e={...this.filters,...this.forcedFilters};return this.parentKeyValuePair.parentFKey&&this.parentKeyValuePair.parentFVal&&(e[this.parentKeyValuePair.parentFKey]=this.parentKeyValuePair.parentFVal),e},headers(){return S.SupaerTableHeaders(this.model,this.excludedCols,this.canEdit,this.displayMapField)},mapHeaders(){return S.SupaerTableHeaders(this.model,this.excludedCols,this.canEdit,!0)},modelFields(){return S.computedAttrs(this.model,this.excludedCols)},pKey(){return this.model.primaryKey},maxPages(){return Math.ceil(this.itemsLength/this.options.itemsPerPage)}},methods:{createItem(){this.$refs.CrudModalRef.createItem()},deleteItem(e){this.$emit("deleteItem",e),this.$refs.CrudModalRef.deleteItem(e)},editItem(e){this.$emit("editItem",e),this.$refs.CrudModalRef.editItem(e)},doSearch(e){this.filters[this.model.titleKey]=e,this.fetchData()},pageUpdate(e){this.options={...this.options,page:e},this.fetchData()},updatePagination(e){this.options={...this.options,page:e.page,itemsPerPage:e.rowsPerPage,sortBy:e.sortBy,descending:e.descending},this.fetchData()},quickListsGetIfMatchesAllChecks(e,l){return S.quickListsGetIfMatchesAllChecks(e,l)},clickRow(e,l){this.isForSelectingRelation?this.highlightedRow=e:this.model.rules.readable(l)&&(typeof this.model.openRecord=="function"?this.model.openRecord(l[this.pKey],l,this.$router):this.$emit("clickRow",e,l,this.$router)),this.$emit("update:modelValue",e)},createdItem(e){this.isForSelectingRelation&&(this.$emit("update:modelValue",e[this.superOptions.model.primaryKey]),this.$refs.selectRef.hidePopup())},applyFilters(e,l){const t={};return Object.keys(l).forEach(s=>{const[i,a]=s.split(".");t[i]||(t[i]={}),t[i][a]=l[s]}),e.filter(s=>Object.keys(t).every(i=>{const a=t[i];return s[i]?s[i].some(d=>Object.keys(a).every(r=>d[r]===a[r])):!1}))},async fetchData(){var e,l,t,s,i;try{if(!this.activated&&this.isForSelectingRelation)return;this.loading=!0,this.loadingError=!1;let a=[];(e=this.model.rules)!=null&&e.readables&&(a=this.model.rules.readables());let d={},r={};this.model.adapator=="supabase"?(d={Prefer:"count=exact"},r={order:"id.desc"}):this.model.adapator=="laravel"&&(d={},r={sort:`-${this.model.primaryKey}`,per_page:this.options.itemsPerPage,page:this.options.page});const u=await this.model.FetchAll(this.relationships,{...a,...r,...this.fetchFlags},d,{page:this.options.page,limit:this.options.itemsPerPage,filters:this.filtersComp,clearPrimaryModelOnly:!1});this.items=u.response.data.data,this.loading=!1;let f=0;this.model.adapator=="supabase"?(t=(l=u==null?void 0:u.response)==null?void 0:l.headers)!=null&&t["content-range"]&&(f=((i=(s=u==null?void 0:u.response)==null?void 0:s.headers)==null?void 0:i["content-range"]).split("/")[1]):this.model.adapator=="laravel"&&(f=u.response.data.total),this.itemsLength=f,this.$emit("fetchComplete",this.model.name,this.items)}catch{this.loading=!1,this.loadingError=!0}},activateAndFetchData(){!this.activated&&!this.disabled&&(this.activated=!0,this.fetchData())}},watch:{forcedFilters:{handler(e,l){JSON.stringify(e)!==JSON.stringify(l)&&(this.activated=!1,this.items=[])},deep:!0},items(e){e.length&&this.$emit("update:items",e)},search(e){this.disabled||(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.doSearch(e)},300))},filters:{handler(){!this.loading&&!this.justCreateButton&&this.fetchData()},deep:!0}},mounted(){this.$emit("superTableMounted"),this.activeTab=this.viewAs.default,(this.activated||!this.isForSelectingRelation)&&(this.justCreateButton||this.fetchData())}},ra={class:""},sa={class:"flex flex-center"},da={key:1,class:""};function oa(e,l,t,s,i,a){const d=k("CreateButton"),r=k("SuperSelect"),u=k("SuperTableTopBar"),f=k("SuperTableTable"),p=k("SuperTableGrid"),y=k("SuperTableMap"),M=k("SuperCalendar"),V=k("CrudModal");return n(),o("div",null,[t.justCreateButton?(n(),o(b,{key:1},[a.superOptions.model.rules.creatable()&&a.canCreateComputed&&!t.hideCreate?(n(),h(d,{key:0,modelFields:a.modelFields,onCreateItem:a.createItem,model:t.model,superOptions:a.superOptions,template:t.templateForm,createButtonText:t.createButtonText},null,8,["modelFields","onCreateItem","model","superOptions","template","createButtonText"])):g("",!0)],64)):(n(),o(b,{key:0},[t.isForSelectingRelation?(n(),h(r,{key:0,ref:"selectRef",forcedFilters:t.forcedFilters,readonly:t.disabled,allowAll:t.allowAll,dense:"",hideLabel:t.hideLabel,page:i.options.page,"onUpdate:page":a.pageUpdate,maxPages:a.maxPages,onClick:a.activateAndFetchData,items:i.items,loading:i.loading,rules:t.rules,modelValue:t.modelValue,"onUpdate:modelValue":a.clickRow,model:t.model,modelField:t.modelField,activated:i.activated,onSearch:a.doSearch,errorMessage:t.errorMessage,hideBottomSpace:t.selectHideBottomSpace},{default:c(()=>[a.superOptions.model.rules.creatable()&&a.canCreateComputed&&!t.hideCreate?(n(),h(d,{key:0,modelFields:a.modelFields,onCreateItem:a.createItem,model:t.model,superOptions:a.superOptions,template:t.templateForm,createButtonText:t.createButtonText},null,8,["modelFields","onCreateItem","model","superOptions","template","createButtonText"])):g("",!0)]),_:1},8,["forcedFilters","readonly","allowAll","hideLabel","page","onUpdate:page","maxPages","onClick","items","loading","rules","modelValue","onUpdate:modelValue","model","modelField","activated","onSearch","errorMessage","hideBottomSpace"])):(n(),o(b,{key:1},[m(u,{modelValue:i.filters,"onUpdate:modelValue":l[0]||(l[0]=T=>i.filters=T),activeTab:i.activeTab,"onUpdate:activeTab":l[1]||(l[1]=T=>i.activeTab=T),search:i.search,"onUpdate:search":l[2]||(l[2]=T=>i.search=T),ref:"SuperTableTopBar",superOptions:a.superOptions,viewAs:t.viewAs,downloadables:t.downloadables,noBorder:t.noBorder,canCreateComputed:a.canCreateComputed,canEdit:a.canEdit,hideCreate:t.hideCreate,isForSelectingRelation:t.isForSelectingRelation,startFieldName:a.startFieldName,longField:a.longField,allowedFilters:t.allowedFilters,templateListTable:t.templateListTable,templateForm:t.templateForm,onCreateItem:a.createItem},null,8,["modelValue","activeTab","search","superOptions","viewAs","downloadables","noBorder","canCreateComputed","canEdit","hideCreate","isForSelectingRelation","startFieldName","longField","allowedFilters","templateListTable","templateForm","onCreateItem"]),I("div",ra,[i.activeTab=="table"?(n(),o(b,{key:0},[I("div",null,[t.noBorder?(n(),h(f,{key:1,items:i.items,loading:i.loading,onClickRow:a.clickRow,templateListTable:t.templateListTable,hidePagination:t.hidePagination,excludedCols:a.excludedCols,model:t.model,displayMapField:t.displayMapField,canEdit:a.canEdit,onEditItem:a.editItem,onDeleteItem:a.deleteItem,loadingError:i.loadingError},null,8,["items","loading","onClickRow","templateListTable","hidePagination","excludedCols","model","displayMapField","canEdit","onEditItem","onDeleteItem","loadingError"])):(n(),h(R,{key:0,class:""},{default:c(()=>[m(f,{ref:"SuperTableTableRef",items:i.items,loading:i.loading,onClickRow:a.clickRow,templateListTable:t.templateListTable,hidePagination:t.hidePagination,excludedCols:a.excludedCols,model:t.model,displayMapField:t.displayMapField,canEdit:a.canEdit,onEditItem:a.editItem,onDeleteItem:a.deleteItem,loadingError:i.loadingError},null,8,["items","loading","onClickRow","templateListTable","hidePagination","excludedCols","model","displayMapField","canEdit","onEditItem","onDeleteItem","loadingError"])]),_:1}))]),I("div",sa,[!t.hidePagination&&i.items.length?(n(),h(ce,{key:0,class:E(["q-mt-sm",t.noBorder?"q-mx-md":""]),modelValue:i.options.page,"onUpdate:modelValue":[l[3]||(l[3]=T=>i.options.page=T),a.pageUpdate],max:a.maxPages,input:""},null,8,["class","modelValue","onUpdate:modelValue","max"])):g("",!0)])],64)):g("",!0),i.activeTab=="grid"?(n(),o("div",da,[m(p,{items:i.items,onClickRow:a.clickRow,superOptions:a.superOptions,unClickable:t.unClickable,templateListGrid:t.templateListGrid,onEditItem:a.editItem,onDeleteItem:a.deleteItem,excludedCols:a.excludedCols,loading:i.loading},null,8,["items","onClickRow","superOptions","unClickable","templateListGrid","onEditItem","onDeleteItem","excludedCols","loading"])])):g("",!0),i.activeTab=="map"?(n(),h(y,{key:2,mapHeaders:a.mapHeaders,items:i.items,onClickRow:a.clickRow,superOptions:a.superOptions,onEditItem:a.editItem,onDeleteItem:a.deleteItem,unClickable:t.unClickable,templateListGrid:t.templateListGrid},null,8,["mapHeaders","items","onClickRow","superOptions","onEditItem","onDeleteItem","unClickable","templateListGrid"])):g("",!0),i.activeTab=="calendar"?(n(),o(b,{key:3},[t.noBorder?(n(),h(M,{key:1,onClickRow:a.clickRow,onEditItem:a.editItem,onDeleteItem:a.deleteItem,loading:i.loading,mixedConfigs:[{templateListCalendar:t.templateListCalendar,startFieldName:a.startFieldName,endFieldName:a.endFieldName,items:i.items,superOptions:a.superOptions,unClickable:t.unClickable}]},null,8,["onClickRow","onEditItem","onDeleteItem","loading","mixedConfigs"])):(n(),h(R,{key:0,class:"q-pa-sm"},{default:c(()=>[m(M,{onClickRow:a.clickRow,onEditItem:a.editItem,onDeleteItem:a.deleteItem,loading:i.loading,mixedConfigs:[{templateListCalendar:t.templateListCalendar,startFieldName:a.startFieldName,endFieldName:a.endFieldName,items:i.items,superOptions:a.superOptions,unClickable:t.unClickable}]},null,8,["onClickRow","onEditItem","onDeleteItem","loading","mixedConfigs"])]),_:1}))],64)):g("",!0)])],64))],64)),m(V,{templateForm:t.templateForm,onFetchData:a.fetchData,onCreatedItem:a.createdItem,ref:"CrudModalRef",superOptions:a.superOptions,parentKeyValuePair:t.parentKeyValuePair},null,8,["templateForm","onFetchData","onCreatedItem","superOptions","parentKeyValuePair"])])}const ua=v(na,[["render",oa],["__file","SuperTable.vue"]]),z=Object.freeze(Object.defineProperty({__proto__:null,default:ua},Symbol.toStringTag,{value:"Module"}));class J{static timeRangeType(){return"timeRangeType"}static timeRangeStart(){return"timeRangeStart"}static timeRangeEnd(){return"timeRangeEnd"}static readOnlyTimestampType(){return"readOnlyTimestampType"}static timestampType(){return"timestampType"}static dateType(){return"dateType"}static location_address_place_name(){return"location_address_place_name"}static mapExtraFormattedAddress(){return"mapExtraFormattedAddress"}static mapExtraPlaceID(){return"mapExtraPlaceID"}static mapExtraGeoLocLong(){return"mapExtraGeoLocLong"}static mapExtraGeoLocLat(){return"mapExtraGeoLocLat"}static mapExtraRelCountry(){return"mapExtraRelCountry"}static mapExtraRelAdminArea1(){return"mapExtraRelAdminArea1"}static mapExtraRelAdminArea2(){return"mapExtraRelAdminArea2"}static mapExtraRelLocality(){return"mapExtraRelLocality"}static mapExtraRelSublocality1(){return"mapExtraRelSublocality1"}static mapExtraRelSublocality2(){return"mapExtraRelSublocality2"}static mapExtraRelSublocality(){return"mapExtraRelSublocality"}static creatorType(){return"creatorType"}static ownerProviderType(){return"ownerProviderType"}static ownerCustomerType(){return"ownerCustomerType"}static childrenApplicationType(){return"childrenApplicationType"}static ownerAppliedToProviderType(){return"ownerAppliedToProviderType"}static ownerApprovedByProviderType(){return"ownerApprovedByProviderType"}static fileImageType(){return"fileImageType"}static htmlField(){return"htmlField"}}export{Ul as C,H as D,J as F,S as Q,W as R,ua as S,j as a,Nl as b,tl as c,be as d,Qe as e,Ue as f,ke as g,ge as h,z as i};
